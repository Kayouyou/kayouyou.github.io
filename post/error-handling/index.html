<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Error Handling | Kayouyou&#39;s Den</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico?v=1663222449412">
<link rel="stylesheet" href="http://localhost:4000/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="åº”ç”¨ç¨‹åºå¦‚ä½•å¤„ç†é”™è¯¯å’Œæ„å¤–å€¼ä¸å¦‚ä½•å¤„ç†æœ‰æ•ˆç»“æœåŒæ ·é‡è¦ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¸€äº›å…³é”®æŠ€æœ¯ï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ä»£ç ä¸­é‡åˆ°é”™è¯¯æ—¶æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚
Swiftæä¾›äº†ä¸€ç§ä½¿ç”¨é”™è¯¯åè®®æ¥å®šä¹‰å’Œå¤„ç†é”™è¯¯çš„æœ¬åœ°æ–¹æ³•ã€‚ç¬¦åˆå®ƒä¸éœ€è¦æˆ‘ä»¬æ·»åŠ ä»»ä½•ç‰¹å®šçš„å±æ€§æˆ–æ–¹æ³•ï¼Œæ‰€..." />
    <meta name="keywords" content="control flow,errors" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="http://localhost:4000">
        <img src="http://localhost:4000/images/avatar.png?v=1663222449412" class="site-logo">
        <h1 class="site-title">Kayouyou&#39;s Den</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      The wise build bridges, while the foolish build barriers.
    </div>
    <div class="site-footer">
      è±«ICPå¤‡2021012281å·-1  | <a class="rss" href="http://localhost:4000/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Error Handling</h2>
            <div class="post-date">2019-03-12</div>
            
            <div class="post-content" v-pre>
              <p>åº”ç”¨ç¨‹åºå¦‚ä½•å¤„ç†é”™è¯¯å’Œæ„å¤–å€¼ä¸å¦‚ä½•å¤„ç†æœ‰æ•ˆç»“æœåŒæ ·é‡è¦ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¸€äº›å…³é”®æŠ€æœ¯ï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ä»£ç ä¸­é‡åˆ°é”™è¯¯æ—¶æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p>
<p>Swiftæä¾›äº†ä¸€ç§ä½¿ç”¨é”™è¯¯åè®®æ¥å®šä¹‰å’Œå¤„ç†é”™è¯¯çš„æœ¬åœ°æ–¹æ³•ã€‚ç¬¦åˆå®ƒä¸éœ€è¦æˆ‘ä»¬æ·»åŠ ä»»ä½•ç‰¹å®šçš„å±æ€§æˆ–æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è½»æ¾åœ°ä½¿ä»»ä½•ç±»å‹ç¬¦åˆå®ƒ - ä¾‹å¦‚è¿™ä¸ªæšä¸¾åŒ…å«äº†åœ¨éªŒè¯å­—ç¬¦ä¸²å€¼æ—¶å¯èƒ½é‡åˆ°çš„ä¸€äº›ä¸åŒçš„é”™è¯¯:</p>
<pre><code class="language-swift">enum ValidationError: Error {
    case tooShort
    case tooLong
    case invalidCharacterFound(Character)
}
</code></pre>
<p>ä½¿ç”¨ä¸Šé¢çš„error enumï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ç¼–å†™ä¸€ä¸ªç®€å•çš„å‡½æ•°æ¥éªŒè¯ç»™å®šçš„ç”¨æˆ·åæ˜¯å¦å¤ªé•¿æˆ–å¤ªçŸ­ï¼Œå¹¶ä¸”å®ƒä¸åŒ…å«ä»»ä½•éå­—æ¯å­—ç¬¦ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨throwå°†å‡½æ•°æ ‡è®°ä¸ºèƒ½å¤ŸæŠ›å‡ºé”™è¯¯ï¼Œå¹¶ä½¿ç”¨throwå…³é”®å­—åœ¨æœªæ»¡è¶³éªŒè¯è¦æ±‚çš„æƒ…å†µä¸‹è§¦å‘é”™è¯¯â€”â€”åƒè¿™æ ·:</p>
<pre><code class="language-swift">func validate(username: String) throws {
    guard username.count &gt; 3 else {
        throw ValidationError.tooShort
    }

    guard username.count &lt; 15 else {
        throw ValidationError.tooLong
    }

    for character in username {
        guard character.isLetter else {
            throw ValidationError.invalidCharacterFound(character)
        }
    }
}
</code></pre>
<p>ç”±äºæˆ‘ä»¬ç”¨æŠ›å‡ºæ ‡è®°äº†ä¸Šé¢çš„å‡½æ•°ï¼Œç°åœ¨éœ€è¦åœ¨å¯¹å®ƒçš„ä»»ä½•è°ƒç”¨å‰é¢åŠ ä¸Štryå…³é”®å­—â€”â€”è¿™åè¿‡æ¥è¿«ä½¿æˆ‘ä»¬å¤„ç†ä»å®ƒæŠ›å‡ºçš„ä»»ä½•é”™è¯¯(æˆ–ä½¿ç”¨try?å°†å…¶è¿”å›å€¼è½¬æ¢ä¸ºå¯é€‰çš„å€¼)ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å‡½æ•°æ¥éªŒè¯ç”¨æˆ·åˆšåˆšé€‰æ‹©çš„ç”¨æˆ·åï¼Œå¦‚æœéªŒè¯é€šè¿‡(æ²¡æœ‰æŠ›å‡ºé”™è¯¯)ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†ç»§ç»­å‘æœåŠ¡å™¨æäº¤è¯¥ç”¨æˆ·å - å¦åˆ™ï¼Œæˆ‘ä»¬ä¼šæ˜¾ç¤ºä½¿ç”¨UILabelé‡åˆ°çš„é”™è¯¯:</p>
<pre><code class="language-swift">func userDidPickName(_ username: String) {
    do {
        try validate(username: username)
        // If we reach this point in the code, then it means
        // that no error was thrown, and the validation passed.
        submit(username)
    } catch {
        // The variable â€˜errorâ€™ is automatically available
        // inside of â€˜catchâ€™ blocks.
        errorLabel.text = error.localizedDescription
    }
}
</code></pre>
<p>ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬ä»¥æ— æ•ˆçš„ç”¨æˆ·å(ä¾‹å¦‚â€œjohn-sundellâ€)ä½œä¸ºè¾“å…¥è¿è¡Œä¸Šè¿°ä»£ç ï¼Œæˆ‘ä»¬å°†åœ¨errorLabelä¸­æ˜¾ç¤ºä¸€ä¸ªç›¸å½“æ¨¡ç³Šçš„é”™è¯¯æ¶ˆæ¯:</p>
<pre><code class="language-swift">The operation couldnâ€™t be completed. (App.ValidationError error 0.)
</code></pre>
<p>è¿™å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œå› ä¸ºå®ƒæœ€ç»ˆå¯èƒ½ä¼šè®©ç”¨æˆ·æ„Ÿåˆ°å›°æƒ‘ã€‚æ²¡æœ‰å¯æ“ä½œçš„ä¿¡æ¯ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜å‘ç”¨æˆ·å…¬å¼€å®ç°ç»†èŠ‚(å¦‚é”™è¯¯ç±»å‹çš„åç§°)ã€‚</p>
<p>å¹¸è¿çš„æ˜¯ï¼Œè¿™æ˜¯å¾ˆå®¹æ˜“ä¿®å¤çš„-é€šè¿‡å…è®¸æˆ‘ä»¬çš„é”™è¯¯ç±»å‹æœ¬åœ°åŒ–ã€‚ä¸ºæ­¤ï¼Œè®©æˆ‘ä»¬æ‰©å±•ValidationErrorä»¥ç¬¦åˆLocalizedErrorï¼Œè¿™æ˜¯é”™è¯¯åè®®çš„ä¸€ä¸ªç‰¹æ®Šç‰ˆæœ¬ã€‚é€šè¿‡è¿™æ ·åšï¼Œå¹¶å®ç°å…¶errorDescriptionå±æ€§- æˆ‘ä»¬ç°åœ¨å¯ä»¥ä¸ºæ¯ä¸ªé”™è¯¯æƒ…å†µè¿”å›ä¸€ä¸ªåˆé€‚çš„æœ¬åœ°åŒ–æ¶ˆæ¯:</p>
<pre><code class="language-swift">extension ValidationError: LocalizedError {
    var errorDescription: String? {
        switch self {
        case .tooShort:
            return NSLocalizedString(
                &quot;Your username needs to be at least 4 characters long&quot;,
                comment: &quot;&quot;
            )
        case .tooLong:
            return NSLocalizedString(
                &quot;Your username can't be longer than 14 characters&quot;,
                comment: &quot;&quot;
            )
        case .invalidCharacterFound(let character):
            let format = NSLocalizedString(
                &quot;Your username can't contain the character '%@'&quot;,
                comment: &quot;&quot;
            )

            return String(format: format, String(character))
        }
    }
}
</code></pre>
<p>æœ‰äº†ä¸Šé¢çš„æ”¹å˜ï¼Œæˆ‘ä»¬ä¹‹å‰çš„éªŒè¯é”™è¯¯ç°åœ¨å°†ä»¥ä¸€ç§æ›´å‹å¥½çš„æ–¹å¼æ˜¾ç¤º:</p>
<pre><code class="language-swift">Your username can't contain the character '-'
</code></pre>
<p>ğŸ‘å¥½å¤šäº†ã€‚å¥½æ¶ˆæ¯æ˜¯ï¼Œåœ¨å¤„ç†å¼‚æ­¥é”™è¯¯æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åº”ç”¨å¤§éƒ¨åˆ†ç›¸åŒçš„æŠ€æœ¯ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªä»¥å®Œå…¨åŒæ­¥çš„æ–¹å¼å¤„ç†é”™è¯¯å’ŒæŠ›å‡ºå‡½æ•°-ä¸Šé¢ä½¿ç”¨çš„â€œdo, try, catchâ€æ¨¡å¼éå¸¸é€‚åˆè¿™ç§æƒ…å†µ-ä½†å½“æ¶‰åŠåˆ°å¼‚æ­¥ä»£ç æ—¶ï¼Œé”™è¯¯é€šå¸¸ä¼šä¼ é€’ç»™å®Œæˆå¤„ç†ç¨‹åºï¼Œè€Œä¸æ˜¯æŠ›å‡ºã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è®©æˆ‘ä»¬çš„éªŒè¯å‡½æ•°å¼‚æ­¥æ‰§è¡Œâ€”â€”ä¹Ÿè®¸æ˜¯ä¸ºäº†èƒ½å¤Ÿè¿›è¡Œç½‘ç»œç»‘å®šçš„éªŒè¯ï¼Œ æˆ–è€…åœ¨åå°çº¿ç¨‹ä¸Šæ‰§è¡Œæ›´å¤æ‚çš„è§„åˆ™ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†æŠŠå‡½æ•°ç­¾åè½¬æ¢æˆè¿™æ ·:</p>
<pre><code class="language-swift">func validate(username: String,
              then handler: @escaping (ValidationError?) -&gt; Void) {
    ...
}
</code></pre>
<p>ç”±äºé”™è¯¯ç°åœ¨ä½œä¸ºå¯é€‰ä¿¡æ¯ä¼ é€’ç»™å¤„ç†ç¨‹åºé—­åŒ…ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»ä½¿ç”¨ç¨å¾®ä¸åŒçš„ç­–ç•¥æ¥æ•è·å®ƒä»¬ã€‚å€¼å¾—åº†å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰“å¼€è¿™ä¸ªå¯é€‰é€‰é¡¹ï¼Œå¹¶ä½¿ç”¨ç›¸åŒçš„localizedDescriptionå±æ€§æ¥è®¿é—®æœ¬åœ°åŒ–åçš„é”™è¯¯æ¶ˆæ¯â€”â€”è€Œä¸æ˜¯ä½¿ç”¨catchå—:</p>
<pre><code class="language-swift">func userDidPickName(_ username: String) {
    validate(username: username) { error in
        if let error = error {
            errorLabel.text = error.localizedDescription
        } else {
            submit(username)
        }
    }
}
</code></pre>
<p>èŠ±ç‚¹é¢å¤–çš„æ—¶é—´åœ¨åº”ç”¨ä¸­æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†æ–¹æ³•èƒ½å¤Ÿæå‡æ¸¸æˆçš„æ„ŸçŸ¥è´¨é‡ã€‚ æ²¡æœ‰äººå–œæ¬¢è¢«å›°åœ¨ä¸€ä¸ªæ¨¡ç³Šçš„é”™è¯¯ä¿¡æ¯çš„å±å¹•ä¸Šï¼Œè¿™å¹¶æ²¡æœ‰çœŸæ­£è¯´æ˜ä»€ä¹ˆï¼Œä¹Ÿæ²¡æœ‰æä¾›ä»»ä½•å½¢å¼çš„å»ºè®®æ“ä½œæ¥çº æ­£é”™è¯¯ã€‚é€šè¿‡åœ¨é”™è¯¯ç±»å‹ä¸­æ·»åŠ æœ¬åœ°åŒ–ï¼Œä»¥åŠä¸€äº›å¤„ç†å’Œæ˜¾ç¤ºè¿™äº›é”™è¯¯çš„ä»£ç ï¼Œæˆ‘ä»¬æœ‰å¸Œæœ›è®©ç”¨æˆ·æ»¡æ„â€”â€”å³ä½¿ç¡®å®å‡ºç°äº†é”™è¯¯ã€‚</p>
<p><a href="https://www.swiftbysundell.com/basics/error-handling/">åŸæ–‡é“¾æ¥</a></p>

            </div>
            
              <div class="tag-container">
                
                  <a href="http://localhost:4000/tag/n5Ua5GKgs/" class="tag">
                    control flow
                  </a>
                
                  <a href="http://localhost:4000/tag/wQerok9iv/" class="tag">
                    errors
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="http://localhost:4000/post/the-power-of-userdefaults-in-swift/">
                  <h3 class="post-title">
                    The power of UserDefaults in Swift
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
</html>
