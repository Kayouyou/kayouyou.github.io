<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>PointFree Episode 99:Ergonomic State Management: Part 2 | Kayouyou&#39;s Den</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://kayouyou.github.io/favicon.ico?v=1680320045148">
<link rel="stylesheet" href="https://kayouyou.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="



Dynamic member lookup




Dynamic member store




Bindings and the architecture




Binding helpers






1. Dynami..." />
    <meta name="keywords" content="PointFree" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://kayouyou.github.io">
        <img src="https://kayouyou.github.io/images/avatar.png?v=1680320045148" class="site-logo">
        <h1 class="site-title">Kayouyou&#39;s Den</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      The wise build bridges, while the foolish build barriers.
    </div>
    <div class="site-footer">
       <a href="https://beian.miit.gov.cn/">è±«ICPå¤‡2021012281å·-1</a> | <a class="rss" href="https://kayouyou.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">PointFree Episode 99:Ergonomic State Management: Part 2</h2>
            <div class="post-date">2021-12-18</div>
            
            <div class="post-content" v-pre>
              <!-- vscode-markdown-toc -->
<ul>
<li>
<ol>
<li><a href="#Dynamicmemberlookup">Dynamic member lookup</a></li>
</ol>
</li>
<li>
<ol start="2">
<li><a href="#Dynamicmemberstore">Dynamic member store</a></li>
</ol>
</li>
<li>
<ol start="3">
<li><a href="#Bindingsandthearchitecture">Bindings and the architecture</a></li>
</ol>
</li>
<li>
<ol start="4">
<li><a href="#Bindinghelpers">Binding helpers</a></li>
</ol>
</li>
</ul>
<!-- vscode-markdown-toc-config
	numbering=true
	autoSave=true
	/vscode-markdown-toc-config -->
<!-- /vscode-markdown-toc -->
<!-- # PointFree Episode 99:Ergonomic State Management: Part 2 -->
<h2 id="1-a-namedynamicmemberlookupadynamic-member-lookup">1. <a name='Dynamicmemberlookup'></a>Dynamic member lookup</h2>
<p>å¦‚æœæˆ‘ä»¬çœ‹ä¸€ä¸‹<strong>CounterView</strong>ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°7è¡Œéƒ½é‡å¤.<strong>value</strong>ä»¥è·å–å®ƒä»¬æ‰€å…³å¿ƒçš„æ•°æ®:</p>
<pre><code class="language-swift">.disabled(self.viewStore.value.isDecrementButtonDisabled)
â€¦
Text(&quot;\(self.viewStore.value.count)&quot;)
â€¦
.disabled(self.viewStore.value.isIncrementButtonDisabled)
â€¦
Button(self.viewStore.value.nthPrimeButtonTitle) {
â€¦
.disabled(self.viewStore.value.isNthPrimeButtonDisabled)
â€¦
isPresented: .constant(self.viewStore.value.isPrimeModalShown),
â€¦
item: .constant(self.viewStore.value.alertNthPrime)
</code></pre>
<p>è¿™ç§é‡å¤çš„å™ªéŸ³å¹¶ä¸æ˜¯ä¸–ç•Œä¸Šæœ€ç³Ÿç³•çš„äº‹æƒ…ï¼Œä½†æˆ‘è®¤ä¸ºæˆ‘ä»¬æœ‰æœºä¼šåˆ©ç”¨Swiftçš„ç‰¹æ€§æ¥ç®€åŒ–ä¸€äº›äº‹æƒ…ï¼Œé‚£å°±æ˜¯â€œ<strong>dynamic member lookup</strong>â€ã€‚åŠ¨æ€æˆå‘˜æŸ¥æ‰¾å…è®¸æ‚¨å¢å¼ºç±»å‹ï¼Œä½¿å…¶èƒ½å¤Ÿæ¥å—ä¸ç›´æ¥å­˜åœ¨äºè¯¥ç±»å‹ä¸Šçš„å±æ€§çš„ç‚¹è¯­æ³•è°ƒç”¨ã€‚</p>
<p>è®©æˆ‘ä»¬è·³åˆ°<strong>playground</strong>ä¸Šå»çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•è¿ä½œçš„ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„<strong>User</strong>ç»“æ„ä½“ã€‚</p>
<pre><code class="language-swift">struct User {
  var id: Int
  var name: String
  var bio: String
}

let user = User(id: 1, name: &quot;Blob&quot;, bio: &quot;Blobbed around the world&quot;)
</code></pre>
<p>å¦‚æœæˆ‘ä»¬æƒ³æ·»åŠ ä¸€äº›ç®¡ç†åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªé¢å¤–çš„å­—æ®µæ¥å¢å¼º<strong>User</strong>ç±»å‹:</p>
<pre><code class="language-swift">struct User {
  var id: Int
  var name: String
  var bio: String
  var isAdmin: Bool
}

let blob = User(id: 1, name: &quot;Blob&quot;, bio: &quot;Blobbed around the world&quot;, isAdmin: true)

let blobJr = User(id: 2, name: &quot;Blob Jr&quot;, bio: &quot;Blobbed around the world&quot;, isAdmin: false)
</code></pre>
<p>å¹¶ä¸”æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªå­—æ®µæ¥é˜²æ­¢ä»»ä½•ä»…ç”¨äº<strong>admin-only</strong>åŠŸèƒ½ã€‚</p>
<pre><code class="language-swift">func doAdminStuff(user: User) {
  guard user.isAdmin else { return }
  print(&quot;\(user.name) is an admin&quot;)
}

doAdminStuff(user: blob)
// prints &quot;Blob is an admin&quot;

doAdminStuff(user: blobJr)
// prints nothing
</code></pre>
<p>ä¹Ÿè®¸æ›´å¥½çš„æ–¹æ³•æ˜¯ï¼Œå°†ç®¡ç†å‘˜å®Œå…¨åŒºåˆ†ä¸ºè‡ªå·±çš„ç±»å‹ï¼Œå¹¶åŒ…è£…æ›´å¤šçš„åŸºæœ¬ç”¨æˆ·æ•°æ®:</p>
<pre><code class="language-swift">struct User {
  var id: Int
  var name: String
  var bio: String
//  var isAdmin: Bool
}

struct Admin {
  var user: User
}
</code></pre>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥è¦æ±‚å‡½æ•°é‡‡ç”¨<strong>Admin</strong>å€¼è€Œä¸æ˜¯<strong>User</strong>å€¼ã€‚</p>
<pre><code class="language-swift">func doAdminStuff(user: Admin) {
//  guard user.isAdmin else { return }
  print(&quot;\(user.user.name) is an admin&quot;)
}
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨ç¼–è¯‘æ—¶ä¿æŠ¤ä»…ç®¡ç†å‘˜çš„åŠŸèƒ½! ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å…¥ä¸€ä¸ªåªæ¥å—ç®¡ç†å‘˜çš„å‡½æ•°ã€‚</p>
<pre><code class="language-swift">doAdminStuff(user: blob)
doAdminStuff(user: blobJr)
</code></pre>
<blockquote>
<p>ğŸ›‘ Cannot convert value of type â€˜Userâ€™ to expected argument type â€˜Adminâ€™</p>
</blockquote>
<p>ç°åœ¨ï¼Œä¸ºäº†æ‰§è¡Œè¯¥åŠŸèƒ½ï¼Œæˆ‘ä»¬å¿…é¡»æ‰‹å¤´æœ‰ä¸€ä¸ª<strong>Admin</strong>å€¼ã€‚</p>
<pre><code class="language-swift">let blob = Admin(user: User(id: 1, name: &quot;Blob&quot;, bio: &quot;Blobbed around the world&quot;, isAdmin: true))
â€¦
doAdminStuff(user: blob)
// prints &quot;Blob is an admin&quot;

//doAdminStuff(user: blobJr)
</code></pre>
<p>è¿™ç§ç±»å‹å®‰å…¨ç¡®å®æ˜¯ä»¶å¥½äº‹ã€‚</p>
<p>ä¸å¹¸çš„æ˜¯ï¼Œåƒ<strong>Admin</strong>è¿™æ ·çš„åŒ…è£…ç±»å‹çš„ç¼ºç‚¹æ˜¯å®ƒä»¬å¯èƒ½å¸¦æœ‰è®¸å¤šæ ·æ¿ã€‚ä¸ºäº†è®¿é—®ç®¡ç†å‘˜çš„ç”¨æˆ·å­—æ®µï¼Œæˆ‘ä»¬å¿…é¡»éå†å…¶ç”¨æˆ·å­—æ®µã€‚</p>
<pre><code class="language-swift">print(&quot;\(admin.user.name) is an admin&quot;)
</code></pre>
<p>åœ¨åŒ…è£…ç±»å‹ä¸Šç›´æ¥è®¿é—®è¿™äº›å±æ€§ä¼šå¾ˆå¥½:</p>
<pre><code class="language-swift">print(&quot;\(admin.name) is an admin&quot;)
</code></pre>
<blockquote>
<p>ğŸ›‘ Value of type â€˜Adminâ€™ has no member â€˜nameâ€™</p>
</blockquote>
<p>å¥½å§ï¼ŒåŠ¨æ€æˆå‘˜æŸ¥æ‰¾å…è®¸æˆ‘ä»¬è¿™æ ·åš!</p>
<p>ä¸ºäº†ç”¨è¿™ä¸ªåŠŸèƒ½å¢å¼º<strong>Admin</strong>ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨@<strong>dynamicMemberLookup</strong>å±æ€§æ¥æ³¨é‡Šå®ƒã€‚</p>
<pre><code class="language-swift">@dynamicMemberLookup
struct Admin {
</code></pre>
<blockquote>
<p>ğŸ›‘ @dynamicMemberLookup attribute requires â€˜Adminâ€™ to have a â€˜subscript(dynamicMember:)â€™ method that accepts either â€˜ExpressibleByStringLiteralâ€™ or a key path</p>
</blockquote>
<p>å®ƒæœ‰ä¸€ä¸ªè¦æ±‚:ä¸€ä¸ªé‡‡ç”¨å…³é”®è·¯å¾„çš„ä¸‹æ ‡</p>
<pre><code class="language-swift">subscript(dynamicMember keyPath: KeyPath&lt;???, ???&gt;) -&gt; ???
</code></pre>
<p>å®ç°æ­¤ä¸‹æ ‡å°†å…³é”®è·¯å¾„æ ¹çš„æ‰€æœ‰å±æ€§ç›´æ¥æ˜¾ç¤ºåœ¨åŒ…è£…å™¨ç±»å‹ä¸Šã€‚å› æ­¤ï¼Œä¸ºäº†åœ¨<strong>Admin</strong>ä¸Šç›´æ¥æ˜¾ç¤ºæ‰€æœ‰<strong>User</strong>ç±»å‹çš„å­—æ®µï¼Œå…³é”®è·¯å¾„çš„æ ¹åº”è¯¥æ˜¯<strong>User</strong>ï¼Œå€¼åº”è¯¥æ˜¯æŸä¸ªæ³›å‹ç±»å‹Aã€‚</p>
<pre><code class="language-swift">subscript&lt;A&gt;(dynamicMember keyPath: KeyPath&lt;User, A&gt;) -&gt; A
</code></pre>
<p>åœ¨æ­£æ–‡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠé”®è·¯å¾„ä¼ é€’ç»™ç”¨æˆ·çš„é”®è·¯å¾„ä¸‹æ ‡ã€‚</p>
<pre><code class="language-swift">subscript&lt;A&gt;(dynamicMember keyPath: KeyPath&lt;User, A&gt;) -&gt; A
  self.user[keyPath: keyPath]
}
</code></pre>
<p>åœ¨è¿™å‡ è¡Œä»£ç ä¸­ï¼Œæœ‰å¾ˆå¤šäº‹æƒ…è¦åšï¼Œä½†å®ƒè¯´çš„æ˜¯ï¼Œå½“è¿™ä¸ªä¸‹æ ‡è¢«ä¸€ä¸ªå…³é”®è·¯å¾„è°ƒç”¨æ—¶ï¼Œå®ƒå¯ä»¥æŠŠå®ƒè½¬å‘ç»™ä¸€ä¸ªåº•å±‚å€¼ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°±æ˜¯<strong>user</strong>ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬çš„<strong>doAdminStuff</strong>å‡½æ•°æ­£åœ¨ç¼–è¯‘å¹¶å†æ¬¡è¿è¡Œï¼Œä½†æ˜¯æˆ‘ä»¬åº”è¯¥æ³¨æ„ï¼Œè®¿é—®ç®¡ç†å‘˜ç”¨æˆ·ä¸Šçš„ä»»ä½•åº•å±‚å€¼éƒ½å¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p>
<pre><code class="language-swift">blob.id   // 1
blob.name // &quot;Blob&quot;
</code></pre>
<p>è¿™çœŸçš„å¾ˆé…·!æˆ‘ä»¬èƒ½å¤Ÿå¹³é“ºä¸€å †åµŒå¥—è°ƒç”¨å¹¶æ¶ˆé™¤å™ªå£°ã€‚ <strong>Admin</strong>ç±»å‹ç°åœ¨çš„è¡Œä¸ºä¸<strong>User</strong>å‡ ä¹å®Œå…¨ç›¸åŒï¼Œä½†å®ƒæ˜¯è‡ªå·±çš„ã€å¯åŒºåˆ†çš„ç±»å‹ã€‚è¿™å‡ ä¹å°±å¥½åƒæˆ‘ä»¬å·²ç»è·å¾—äº†ç±»ç»§æ‰¿çš„å¥½å¤„ï¼Œä½†æ²¡æœ‰å¼•ç”¨ç±»å‹çš„æ‰€æœ‰åŒ…è¢±ã€‚</p>
<hr>
<h2 id="2-a-namedynamicmemberstoreadynamic-member-store">2. <a name='Dynamicmemberstore'></a>Dynamic member store</h2>
<p>é‚£ä¹ˆï¼ŒåŠ¨æ€æˆå‘˜æŸ¥æ‰¾å¦‚ä½•æ”¹è¿›æˆ‘ä»¬æ¶æ„çš„äººä½“å·¥ç¨‹å­¦å‘¢? <strong>ViewStore</strong>ç±»å‹ä¹Ÿæ˜¯ä¸€ä¸ªåŒ…è£…å™¨! å®ƒæŒæœ‰è¡¨ç¤ºåº”ç”¨ç¨‹åºçŠ¶æ€çš„<strong>value</strong>å­—æ®µã€‚</p>
<pre><code class="language-swift">public final class ViewStore&lt;Value, Action&gt;: ObservableObject {
  // â€¦
  @Published public private(set) var value: Value
</code></pre>
<pre><code class="language-swift">@dynamicMemberLookup
public final class ViewStore&lt;Value, Action&gt;: ObservableObject {
</code></pre>
<blockquote>
<p>ğŸ›‘ @dynamicMemberLookup attribute requires â€˜Storeâ€™ to have a â€˜subscript(dynamicMember:)â€™ method that accepts either â€˜ExpressibleByStringLiteralâ€™ or a keypath</p>
</blockquote>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥å®ç°ä¸‹æ ‡:</p>
<pre><code class="language-swift">public subscript&lt;LocalValue&gt;(dynamicMember keyPath: KeyPath&lt;Value, LocalValue&gt;) -&gt; LocalValue {
  return self.value[keyPath: keyPath]
}
</code></pre>
<p>è¿™ä¸ªå®ç°çœ‹èµ·æ¥å¾ˆåƒæˆ‘ä»¬åœ¨<strong>Admin</strong>ä¸Šå®ç°çš„é‚£ä¸ªï¼Œæˆ‘ä»¬åªæ˜¯å°†é”®è·¯å¾„ä¼ é€’ç»™åŒ…è£…å€¼çš„ä¸‹æ ‡ã€‚</p>
<p>åœ¨æˆ‘ä»¬çš„è§†å›¾ä¸­ï¼Œæˆ‘ä»¬ç°åœ¨åº”è¯¥èƒ½å¤Ÿé€šè¿‡æˆ‘ä»¬æ‰€æ“ä½œçš„<strong>value</strong>åˆ é™¤æ‰€æœ‰åµŒå¥—è°ƒç”¨ã€‚</p>
<p><strong>counter</strong>è§†å›¾æœ‰å¾ˆå¤šæˆ‘ä»¬å¯ä»¥ä¿®æ”¹çš„åœ°æ–¹ã€‚</p>
<pre><code class="language-swift">public struct CounterView: View {
  â€¦
  public var body: some View {
    print(&quot;CounterView.body&quot;)
    return VStack {
      HStack {
        Button(&quot;-&quot;) { self.viewStore.send(.decrTapped) }
          .disabled(self.viewStore.isDecrementButtonDisabled)
        Text(&quot;\(self.viewStore.count)&quot;)
        Button(&quot;+&quot;) { self.viewStore.send(.incrTapped) }
          .disabled(self.viewStore.isIncrementButtonDisabled)
      }
      Button(&quot;Is this prime?&quot;) { self.viewStore.send(.isPrimeButtonTapped) }
      Button(self.viewStore.nthPrimeButtonTitle) {
        self.viewStore.send(.nthPrimeButtonTapped)
      }
      .disabled(self.viewStore.isNthPrimeButtonDisabled)
    }
    .font(.title)
    .navigationBarTitle(&quot;Counter demo&quot;)
    .sheet(
      isPresented: .constant(self.viewStore.isPrimeModalShown),
      onDismiss: { self.viewStore.send(.primeModalDismissed) }
    ) {
      IsPrimeModalView(
        store: self.store.scope(
          value: { ($0.count, $0.favoritePrimes) },
          action: { .primeModal($0) }
        )
      )
    }
    .alert(
      item: .constant(self.viewStore.alertNthPrime)
    ) { alert in
      Alert(
        title: Text(alert.title),
        dismissButton: .default(Text(&quot;Ok&quot;)) {
          self.viewStore.send(.alertDismissButtonTapped)
        }
      )
    }
    .frame(minWidth: 0, maxWidth: .infinity, minHeight: 0, maxHeight: .infinity)
    .background(Color.white)
    .onTapGesture(count: 2) {
      self.viewStore.send(.doubleTap)
    }
  }
}
</code></pre>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>find-replace</strong>æ¥æ›´æ–°æ‰€æœ‰å†…å®¹ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨å°†è¿™äº›æ›´æ”¹åº”ç”¨åˆ°æ¯ä¸ªè§†å›¾ã€‚</p>
<p>ç°åœ¨è¿™äº›éƒ½æ˜¯å°çš„ï¼Œä½†å¾ˆå¥½çš„æ”¹å˜ï¼Œå®ƒå°†ä¸ä»£ç åº“çš„å¤§å°ç›¸ä¹˜ã€‚å®ƒè¯»èµ·æ¥ä¹Ÿå¾ˆå¥½ï¼Œå°±åƒæˆ‘ä»¬ç›´æ¥å‘<strong>store</strong>è¯¢é—®å®ƒåŒ…å«çš„æŸäº›çŠ¶æ€ã€‚å®ƒåŸºæœ¬ä¸Šä¸éœ€è¦å·¥ä½œã€‚å› æ­¤ï¼Œåœ¨å¤„ç†åŒ…è£…å™¨ç±»å‹æ—¶ï¼Œè¦è®°ä½è¿™æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„æŠ€å·§ã€‚</p>
<hr>
<h2 id="3-a-namebindingsandthearchitectureabindings-and-the-architecture">3. <a name='Bindingsandthearchitecture'></a>Bindings and the architecture</h2>
<p>æ‰€ä»¥åŠ¨æ€æˆå‘˜æŸ¥æ‰¾å¸®åŠ©æˆ‘ä»¬çš„è§†å›¾å‡å°‘äº†å™ªéŸ³ï¼Œä½†æ‘†è„±äº†æ‰€æœ‰çš„<strong>viewStore.value</strong>é‡å¤ï¼Œè¿™å¾ˆå¥½ã€‚åœ¨æˆ‘ä»¬çš„è§†å›¾ä¸­è¿˜æœ‰ä¸€ä¸ªæ›´éº»çƒ¦çš„ä¸œè¥¿æˆ‘æƒ³æˆ‘ä»¬å¯ä»¥æ¸…ç†ä¸€ä¸‹ï¼Œè®©æˆ‘ä»¬çš„è§†å›¾æ›´ç®€å•ï¼Œé‚£å°±æ˜¯ç»‘å®šã€‚</p>
<p><strong>SwiftUI</strong>ä¸­ç»å¸¸ä½¿ç”¨ç»‘å®šä½œä¸ºä¸¤ä¸ªç»„ä»¶ä¹‹é—´çš„åŒå‘é€šä¿¡å½¢å¼ã€‚ å®ƒä»¬çœŸçš„å¾ˆå¼ºå¤§ï¼Œå¯ä»¥è®©ä½ éå¸¸è¿…é€Ÿåœ°å®Œæˆä»»åŠ¡ï¼Œä½†å®ƒä»¬ä¹Ÿå¸¦æ¥äº†ä¸€äº›å¤æ‚æ€§æˆæœ¬ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹åˆ°ç›®å‰ä¸ºæ­¢åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„å‡ ä¸ªç»‘å®šã€‚</p>
<p>ç›®å‰ï¼Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­æœ‰5ä¸ªç»‘å®šã€‚å…¶ä¸­ä¸€ä¸ªåœ¨æœ€å–œæ¬¢çš„è´¨æ•°å±å¹•ä¸Šï¼Œä¸¤ä¸ªåœ¨è®¡æ•°å™¨å±å¹•ä¸Šï¼Œè¿˜æœ‰ä¸¤ä¸ªåœ¨æˆ‘ä»¬çš„macOSåº”ç”¨ç¨‹åºçš„è®¡æ•°å™¨å±å¹•ä¸Šã€‚åœ¨æœ€å–œçˆ±çš„å¯åŠ¨å±å¹•ä¸Šçš„ç»‘å®šç”¨æ¥é©±åŠ¨æ˜¾ç¤ºå’Œéšè—<strong>alert</strong>:</p>
<pre><code class="language-swift">.alert(item: .constant(self.viewStore.alertNthPrime)) { primeAlert in
  Alert(
    title: Text(primeAlert.title),
    dismissButton: Alert.Button.default(Text(&quot;Ok&quot;), action: {
      self.viewStore.send(.alertDismissButtonTapped)
}))
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå¸¸é‡ç»‘å®šï¼Œå½“<strong>alertNthPrime</strong>å˜ä¸º<strong>énil</strong>æ—¶æ˜¾ç¤ºè­¦æŠ¥ï¼Œå½“å®ƒå˜ä¸º<strong>nil</strong>æ—¶éšè—è­¦æŠ¥ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªå¸¸é‡ç»‘å®šï¼Œå› ä¸ºä¸å…è®¸<strong>alert</strong>ç›´æ¥æ›´æ”¹<strong>alertNthPrime</strong>ã€‚åœ¨å¯ç»„åˆæ¶æ„ä¸­ï¼Œå¯¹çŠ¶æ€è¿›è¡Œæ›´æ”¹çš„å”¯ä¸€æ–¹æ³•æ˜¯å‘é€ä¸€ä¸ªæ“ä½œã€‚äº‹å®ä¸Šï¼Œ<strong>view store</strong>ä¸Šçš„<strong>alertNthPrime</strong>å€¼ç”šè‡³æ˜¯ä¸å¯å†™çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çœŸçš„åˆ«æ— é€‰æ‹©ã€‚</p>
<p>ä½†æ˜¯ï¼Œåœ¨ä¸€å¤©ç»“æŸçš„æ—¶å€™ï¼Œæˆ‘ä»¬ç¡®å®éœ€è¦æŠŠçŠ¶æ€æ›´æ–°ä¸ºnilï¼Œæ¯”å¦‚å½“ä»–ä»¬ç‚¹å‡»è­¦æŠ¥ä¸Šçš„&quot;ç¡®å®š&quot;æŒ‰é’®æ—¶ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå½“æˆ‘ä»¬å°†dimissæŒ‰é’®æ·»åŠ åˆ°è­¦å‘Šæ—¶æˆ‘ä»¬ä¼šç‚¹å‡»å®ƒçš„åŠ¨ä½œé—­åŒ…ä»¥ä¾¿æˆ‘ä»¬å¯ä»¥å‘é€<strong>alertDismissButtonTapped</strong>åŠ¨ä½œã€‚è¿™ä½¿æˆ‘ä»¬çš„çŠ¶æ€ä¸SwiftUIä¿æŒåŒæ­¥ã€‚</p>
<p>åœ¨<strong>counter</strong>è§†å›¾ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€äº›ç±»ä¼¼çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬è¿˜æœ‰å¦ä¸€ä¸ªç»‘å®šï¼Œç”¨æ¥é©±åŠ¨<strong>alert</strong>:</p>
<pre><code class="language-swift">.alert(
  item: .constant(self.viewStore.alertNthPrime)
) { alert in
  Alert(
    title: Text(alert.title),
    dismissButton: .default(Text(&quot;Ok&quot;)) {
      self.viewStore.send(.alertDismissButtonTapped)
    }
  )
}
</code></pre>
<p>åœ¨è¿™ä¸ªç»‘å®šä¹‹ä¸Šï¼Œæˆ‘ä»¬æ˜¾ç¤ºäº†ä¸€ä¸ªåŸºäºæŸäº›çŠ¶æ€çš„æ¨¡æ€:</p>
<pre><code class="language-swift">.sheet(
  isPresented: .constant(self.viewStore.isPrimeModalShown),
  onDismiss: { self.viewStore.send(.primeModalDismissed) }
) {
</code></pre>
<p>è¿™ä½¿å¾—ä¸€æ—¦<strong>isPrimeModalShown</strong>å˜ä¸ºtrueæ¨¡æ€å°±ä¼šæ˜¾ç¤ºï¼Œç„¶åä¸€æ—¦<strong>isPrimeModalShown</strong>å˜ä¸ºfalseå°±è¢«éšè—ã€‚æ›´è¿›ä¸€æ­¥ï¼Œå½“æ¨¡æ€è¢«<strong>dismissed</strong>æ—¶ï¼Œè¿™ä¸ªé—­åŒ…è¢«è°ƒç”¨ï¼Œè€Œä¸æ˜¯å°è¯•ç›´æ¥æ”¹å˜æˆ‘ä»¬çš„çŠ¶æ€ï¼Œæˆ‘ä»¬åªæ˜¯å‘é€ä¸€ä¸ªåŠ¨ä½œåˆ°<strong>view store</strong>ï¼Œä»¥ä¾¿æˆ‘ä»¬çš„ç®€åŒ–ç¨‹åºå¯ä»¥å¤„ç†å®ƒã€‚</p>
<p>æœ€åï¼Œåœ¨macOSè§†å›¾ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ç±»ä¼¼çš„ä¸œè¥¿ï¼Œé™¤äº†è¿™é‡Œçš„å¼¹å‡ºçª—å£æ˜¯ç”±ç»‘å®šæä¾›çš„ï¼Œè¿˜æœ‰ä¸€ä¸ªè­¦å‘Š:</p>
<pre><code class="language-swift">.popover(
  isPresented: Binding(
    get: { self.viewStore.isPrimePopoverShown },
    set: { _ in self.viewStore.send(.primePopoverDismissed) }
  )
) {

.alert(
  item: .constant(self.viewStore.alertNthPrime)
) { alert in
</code></pre>
<p>åœ¨è¿™äº›ä¾‹å­ä¸­ï¼Œæœ‰å¾ˆå¤šä¸åŒçš„æ–¹æ³•ã€‚æœ‰æ—¶æˆ‘ä»¬ä½¿ç”¨.<strong>constant</strong>ç»‘å®šï¼Œç„¶åè¿›å…¥ä¸€ä¸ªå¤–éƒ¨äº‹ä»¶æ¥å‘é€ä¸€ä¸ªè§£æ•£åŠ¨ä½œï¼Œæœ‰æ—¶æˆ‘ä»¬é€šè¿‡å®ç°ä»è§†å›¾å­˜å‚¨åŒºè¿”å›çŠ¶æ€çš„getteræ¥ä»å¤´æ„å»ºç»‘å®šï¼Œè€Œsetteråˆ™å‘è§†å›¾å­˜å‚¨åŒºå‘é€ä¸€ä¸ªåŠ¨ä½œã€‚</p>
<p>è€å®è¯´ï¼Œå…¶ä¸­ä¸€äº›æ–¹æ³•å¹¶ä¸å®Œå…¨æ­£ç¡®ğŸ˜¬ã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨.<strong>constant</strong>ç»‘å®šæ—¶ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¿½ç•¥äº†å¯¹ç»‘å®šæ‰€åšçš„ä»»ä½•å†™å…¥æ“ä½œã€‚ä½†æœ‰æ—¶å†™å…¥è¿™ä¸ªç»‘å®šå®é™…ä¸Šæ˜¯åˆæ³•çš„ã€‚</p>
<p>ä¾‹å¦‚ï¼Œç°åœ¨æˆ‘ä»¬é€šè¿‡ç‚¹å‡»è§£æ•£æŒ‰é’®æ¥å‘é€ä¸€ä¸ªåŠ¨ä½œæ¥å¤„ç†â€œnth prime'â€è­¦æŠ¥çš„è§£æ•£:</p>
<pre><code class="language-swift">.alert(
  item: .constant(self.viewStore.alertNthPrime)
) { alert in
  Alert(
    title: Text(alert.title),
    dismissButton: .default(Text(&quot;Ok&quot;)) {
      self.viewStore.send(.alertDismissButtonTapped)
    }
  )
}
</code></pre>
<p>è¿™å…è®¸æˆ‘ä»¬çš„<strong>reducer</strong>æ¸…é™¤ä¸è­¦æŠ¥ç›¸å…³çš„çŠ¶æ€ï¼Œè¿™ä½¿å¾—è­¦æŠ¥åœ¨UIä¸­æ¶ˆå¤±ã€‚</p>
<p>ç„¶è€Œï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¿˜è®°ä»‹å…¥è¿™ä¸€<strong>dismissal</strong>è¡ŒåŠ¨ã€‚å‡ ä¸ªæœˆåï¼Œå½“æˆ‘ä»¬ä¸å¤ªç†Ÿæ‚‰å¯ç»„åˆæ¶æ„çš„æ‰€æœ‰å†…éƒ¨å·¥ä½œåŸç†æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæƒ³è¿™æ ·åš:</p>
<pre><code class="language-swift">.alert(
  item: .constant(self.viewStore.alertNthPrime)
) { alert in
  Alert(
    title: Text(alert.title),
    dismissButton: .default(Text(&quot;Ok&quot;))
  )
}
</code></pre>
<p>æˆ–è€…æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¦‚æœä½ ä¸æä¾›ä»»ä½•è­¦å‘ŠæŒ‰é’®ï¼Œä½ å°±ä¼šå¾—åˆ°ä¸€ä¸ªå…è´¹çš„â€œOkâ€æ‹’ç»:</p>
<pre><code class="language-swift">.alert(
  item: .constant(self.viewStore.alertNthPrime)
) { alert in
  Alert(title: Text(alert.title))
}
</code></pre>
<p>å¦‚æœæˆ‘ä»¬åƒè¿™æ ·å®ç°è­¦æŠ¥ï¼Œæˆ‘ä»¬å°±ä¼šå®Œå…¨é”™è¿‡å¯¼è‡´è­¦æŠ¥æ¶ˆå¤±çš„æ“ä½œï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æ°¸è¿œä¸ä¼šæ¸…ç†çŠ¶æ€ã€‚è¦äº†è§£ä¸ºä»€ä¹ˆè¿™æ˜¯æœ‰é—®é¢˜çš„ï¼Œè®©æˆ‘ä»¬è¿è¡Œåº”ç”¨ç¨‹åºï¼Œé’»åˆ°è®¡æ•°å™¨å±å¹•ï¼Œè§¦å‘è­¦æŠ¥ï¼Œå›åˆ°æ ¹å±å¹•ï¼Œç„¶åé’»å›è®¡æ•°å™¨å±å¹•ã€‚å¦‚æœæˆ‘ä»¬åœ¨è¿™ä¸ªå±å¹•ä¸Šåšä»»ä½•åŠ¨ä½œï¼Œæˆ‘ä»¬ä¼šçªç„¶å¾—åˆ°ä¸€ä¸ª<strong>alert</strong>ã€‚è¿™æ˜¯å› ä¸ºåœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„çŠ¶æ€ä¸­<strong>alertNthPrime</strong>ä»ç„¶æœ‰ä¸€ä¸ªénilå€¼ï¼Œè¿™æ„å‘³ç€å®ƒå°†ç»§ç»­é‡æ–°è§¦å‘ï¼Œæˆ‘ä»¬æ°¸è¿œä¸èƒ½å®Œå…¨å…³é—­å®ƒã€‚</p>
<p>å› æ­¤ï¼Œè¿™å°±æ˜¯ç»‘å®šå’Œå¯ç»„åˆæ¶æ„çš„é—®é¢˜æ‰€åœ¨ã€‚ä¸€æ–¹é¢ï¼Œç»‘å®šéå¸¸æœ‰ç”¨ï¼ŒSwiftUIç»å¸¸ä½¿ç”¨å®ƒä»¬æ¥æ§åˆ¶UIç»„ä»¶ã€‚ä½†æ˜¯ï¼Œä»å¦ä¸€æ–¹é¢æ¥è¯´ï¼Œå®ƒä»¬å¹¶ä¸å®Œå…¨é€‚åˆå¯ç»„åˆæ¶æ„æ‰€é‡‡ç”¨çš„å•å‘æ•°æ®æµæŠ€æœ¯ï¼Œå› æ­¤å›´ç»•è¿™ä¸€æŠ€æœ¯è¿›è¡Œå·¥ä½œå°†å¯¼è‡´æˆ‘ä»¬ä»¥ä¸€ç§å¯èƒ½ä¸å®‰å…¨çš„æ–¹å¼ä½¿ç”¨ç»‘å®šã€‚</p>
<hr>
<h2 id="4-a-namebindinghelpersabinding-helpers">4. <a name='Bindinghelpers'></a>Binding helpers</h2>
<p>è§£å†³æ–¹æ¡ˆæ˜¯åˆ›å»ºå¸®åŠ©ç¨‹åºï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿä»å¯ç»„åˆæ¶æ„ä¸­çš„ç±»å‹æ´¾ç”Ÿå‡ºçœŸå®çš„ç»‘å®šã€‚å°½ç®¡æˆ‘ä»¬ä¸å¸Œæœ›å¤–éƒ¨ç¯å¢ƒç›´æ¥æ”¹å˜åº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼Œä½†æˆ‘ä»¬ä»ç„¶å¯ä»¥ç¼–å†™ç»‘å®šï¼Œä½¿å…¶çœ‹èµ·æ¥åƒæ˜¯æˆ‘ä»¬ç›´æ¥è®¾ç½®çŠ¶æ€ï¼Œè€Œå®é™…ä¸Šå®ƒæ˜¯åœ¨å¹•åå‘é€æ“ä½œã€‚</p>
<p>ä¸ºäº†è·å¾—è¿™ä¸ªåŠ©æ‰‹åœ¨è°ƒç”¨ç«™ç‚¹çš„çµæ„Ÿï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬åœ¨macOSåº”ç”¨ç¨‹åºä¸­ç”¨äºå¼¹å‡ºçª—å£çš„ç»‘å®š:</p>
<pre><code class="language-swift">.popover(
  isPresented: Binding(
    get: { self.viewStore.isPrimePopoverShown },
    set: { _ in self.viewStore.send(.primePopoverDismissed) }
  )
</code></pre>
<p>è¿™å®é™…ä¸Šæ˜¯æˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„æœ€æ­£ç¡®çš„ç»‘å®šï¼Œå› ä¸ºå®ƒæ­£ç¡®åœ°å¤„ç†äº†ç»‘å®šçš„<strong>getterå’Œsetter</strong>ã€‚æˆ‘ä»¬æ²¡æœ‰åŠæ³•è®©æˆ‘ä»¬çš„ <strong>view store</strong>çš„çŠ¶æ€ä¸SwiftUIä¸åŒæ­¥ï¼Œå› ä¸ºæˆ‘ä»¬ç¡®ä¿åœ¨ç»‘å®šæ”¹å˜çš„æ—¶å€™å‘é€ä¸€ä¸ªåŠ¨ä½œåˆ°<strong>store</strong>ã€‚</p>
<p>åœ¨è¿™ä¸ªå°ç‰‡æ®µä¸­ä»ç„¶æœ‰ä¸€äº›æ ·æ¿ä»£ç å’Œé‡å¤ä»£ç ã€‚åœ¨getå’Œsetä¸­ï¼Œæˆ‘ä»¬éƒ½è®¿é—®<strong>viewStore</strong>ï¼Œä»¤äººå›°æƒ‘çš„æ˜¯ï¼Œåœ¨setä¸­ï¼Œæˆ‘ä»¬æ ¹æœ¬æ²¡æœ‰è®¾ç½®ä»»ä½•ä¸œè¥¿ï¼Œæˆ‘ä»¬åªæ˜¯å‘é€ä¸€ä¸ªæ“ä½œã€‚<br>
å¦‚æœæˆ‘ä»¬å¯ä»¥ä»<strong>viewStore</strong>ä¸­æ´¾ç”Ÿç»‘å®šï¼Œåªè¦æˆ‘ä»¬ç»™å®ƒä¸€ç§è·å–å’Œå‘é€çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯è·å–å’Œè®¾ç½®ã€‚å®ƒå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·:</p>
<pre><code class="language-swift">.popover(
  isPresented: self.viewStore.binding(
    get: { $0.isPrimePopoverShown },
    send: { _ in .primePopoverDismissed }
  )
</code></pre>
<p>è¿™å¾ˆæ¸…æ¥šï¼Œå½“ç»‘å®šéœ€è¦è·å–å®ƒçš„å€¼æ—¶ï¼Œå®ƒä¼šé€šè¿‡<strong>viewStore</strong>çš„çŠ¶æ€ï¼Œå½“ç»‘å®šéœ€è¦å‘é€ä¸€ä¸ªå€¼æ—¶ï¼Œå®ƒä¼šå‘é€è¿™ä¸ªåŠ¨ä½œã€‚</p>
<p>æ›´å¥½çš„æ˜¯ï¼Œç°åœ¨Swift 5.2å‘å¸ƒäº†ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥ä¸º<strong>getter</strong>è®¾ç½®ä¸€ä¸ªå…³é”®è·¯å¾„:</p>
<pre><code class="language-swift">.popover(
  isPresented: self.viewStore.binding(
    get: \.isPrimePopoverShown,
    send: { _ in .primePopoverDismissed }
  )
</code></pre>
<p>æ›´å¥½çš„æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¸éœ€è¦è®¿é—®è¢«è®¾ç½®çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥æä¾›æˆ‘ä»¬æƒ³è¦åœ¨ç»‘å®šç›´æ¥è®¾ç½®æ—¶å‘é€çš„åŠ¨ä½œ:</p>
<pre><code class="language-swift">.popover(
  isPresented: self.viewStore.binding(
    get: \.isPrimePopoverShown,
    send: .primePopoverDismissed
  )
</code></pre>
<p>ç°åœ¨è¿™æ˜¯è¶…çº§ç®€æ´çš„ï¼Œå®ƒä¿æŠ¤æˆ‘ä»¬åœ¨ç»‘å®šæ›´æ”¹æ—¶ä¸å°å¿ƒå¿˜è®°å‘é€æ“ä½œçš„è¾¹ç¼˜æƒ…å†µã€‚</p>
<p>è®©æˆ‘ä»¬è¯•ç€å®ç°è¿™ä¸ªã€‚æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬å¸Œæœ›è¿™ä¸ªhelperæ–¹æ³•åœ¨<strong>ViewStore</strong>ä¸Šï¼Œå› ä¸ºå®ƒæ˜¯èƒ½å¤Ÿè¯»å–çŠ¶æ€å’Œå‘é€æ“ä½œçš„å¯¹è±¡:</p>
<pre><code class="language-swift">extension ViewStore {
  public func binding(
  ) {
  }
}
</code></pre>
<p>æˆ‘ä»¬éœ€è¦ä¸ºå°†ç”¨äºæ­¤ç»‘å®šçš„å±€éƒ¨å€¼å¼•å…¥ä¸€ä¸ªæ³›å‹ã€‚ä¾‹å¦‚ï¼Œè­¦æŠ¥çš„æœ¬åœ°çŠ¶æ€ä¸º<strong>alertNthPrime</strong>ï¼Œè€Œå¼¹å‡ºçª—å£ç»‘å®šçš„æœ¬åœ°çŠ¶æ€ä¸º<strong>Bool</strong>:</p>
<pre><code class="language-swift">extension ViewStore {
  public func binding&lt;LocalValue&gt;(
  ) {
  }
}
</code></pre>
<p>è¿™ä¸ªæ–¹æ³•éœ€è¦æä¾›ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªç”¨äºæè¿°å¦‚ä½•ä»<strong>view store</strong>çš„å€¼ä¸­è·å–å±€éƒ¨å€¼ï¼Œå¦ä¸€ä¸ªç”¨äºæè¿°è®¾ç½®ç»‘å®šæ—¶å‘é€ä»€ä¹ˆåŠ¨ä½œ:</p>
<pre><code class="language-swift">extension ViewStore {
  public func binding&lt;LocalValue&gt;(
    get: (Value) -&gt; LocalValue,
    send action: Action
  ) {
  }
}
</code></pre>
<p>æˆ‘ä»¬æƒ³ä»è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç»‘å®š:</p>
<pre><code class="language-swift">extension ViewStore {
  public func binding&lt;LocalValue&gt;(
    get: (Value) -&gt; LocalValue,
    send action: Action
  ) -&gt; Binding&lt;LocalValue&gt; {
  }
}
</code></pre>
<p>æœ€åæˆ‘ä»¬å¯ä»¥å®ç°è¿™ä¸ªæ–¹æ³•:</p>
<pre><code class="language-swift">extension ViewStore {
  public func binding&lt;LocalValue&gt;(
    get: @escaping (Value) -&gt; LocalValue,
    send action: Action
  ) -&gt; Binding&lt;LocalValue&gt; {
    Binding(
      get: { get(self.value) },
      set: { _ in self.send(action) }
    )
  }
}
</code></pre>
<p>è¿™æ ·ï¼ŒmacOSåº”ç”¨ç¨‹åºä¸­çš„ä¼ªä»£ç ç°åœ¨å°±å¯ä»¥ç¼–è¯‘äº†ï¼Œæˆ‘ä»¬æœ‰äº†ç»‘å®šåŠ©æ‰‹!</p>
<p>å°½ç®¡è¿™ä¸ªåŠ©æ‰‹åœ¨æˆ‘ä»¬ä¸éœ€è¦æ­£åœ¨è®¾ç½®çš„å€¼çš„æ—¶å€™å·¥ä½œå¾—å¾ˆå¥½ï¼Œä½†æœ‰äº›æ—¶å€™æˆ‘ä»¬ç¡®å®éœ€è¦è¿™ä¸ªå€¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå¦ä¸€ä¸ªé‡è½½ï¼Œå…è®¸æˆ‘ä»¬åŸºäºæ‰€è®¾ç½®çš„å€¼æŒ‡å®šä¸€ä¸ªæ“ä½œ:</p>
<pre><code class="language-swift">public func binding&lt;LocalValue&gt;(
  get: @escaping (Value) -&gt; LocalValue,
  send toAction: @escaping (LocalValue) -&gt; Action
) -&gt; Binding&lt;LocalValue&gt; {
  Binding(
    get: { get(self.value) },
    set: { self.send(toAction($0)) }
  )
}
</code></pre>
<p>å› æ­¤ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨æ–°çš„ç»‘å®šåŠ©æ‰‹æ¥è½¬æ¢æ‰€æœ‰ç°æœ‰çš„ä¸´æ—¶ç»‘å®šï¼Œå¹¶ä½¿æ‰€æœ‰å†…å®¹çœ‹èµ·æ¥éƒ½ä¸€æ ·ã€‚<br>
åœ¨æœ€å–œæ¬¢çš„è´¨æ•°å±å¹•ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å°†å¸¸é‡ç»‘å®šè½¬æ¢ä¸ºç”±<strong>store</strong>é©±åŠ¨çš„ä¸œè¥¿ã€‚</p>
<pre><code class="language-swift">.alert(
//  item: .constant(self.viewStore.alertNthPrime)
  item: self.viewStore.binding(
    get: \.alertNthPrime,
    send: .alertDismissButtonTapped
  )
) { primeAlert in
  Alert(title: Text(primeAlert.title), dismissButton: Alert.Button.default(Text(&quot;Ok&quot;), action: {
    self.viewStore.send(.alertDismissButtonTapped)
  }))
}
</code></pre>
<p>ä½¿ç”¨è¿™ä¸ªå¸®åŠ©å™¨æ›´å¥½ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨å¯ä»¥é€šè¿‡å°†å…¶è¿”å›åˆ°<strong>store</strong>æ¥å“åº”å‘é€åˆ°è¿™ä¸ªç»‘å®šçš„ä»»ä½•å†…å®¹ï¼Œå°½ç®¡å®ƒçœ‹èµ·æ¥è¦å†—é•¿å¾—å¤šã€‚ä¸è¿‡ï¼Œå¦‚æœä½ è¿˜è®°å¾—ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥æ¶ˆå»ä¸€å †å…¶ä»–ä»£ç ï¼ŒåŒ…æ‹¬<strong>dismiss</strong>æŒ‰é’®åŠ¨ä½œï¼Œä»¥åŠ<strong>dismiss</strong>æŒ‰é’®æœ¬èº«ã€‚</p>
<pre><code class="language-swift">.alert(
  item: self.viewStore.binding(
    get: \.alertNthPrime,
    send: .alertDismissButtonTapped
  )
) { primeAlert in
  Alert(title: Text(primeAlert.title))
}
</code></pre>
<p>åœ¨iOSçš„è®¡æ•°å™¨å±å¹•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜æˆ‘ä»¬çš„è­¦æŠ¥ç»‘å®š:</p>
<pre><code class="language-swift">.alert(
  item: self.viewStore.binding(
    get: \.alertNthPrime,
    send: .alertDismissButtonTapped
  )
) { alert in
</code></pre>
<p>è¿™ä¿®å¤äº†æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„é”™è¯¯ï¼Œå³è­¦æŠ¥çŠ¶æ€æ²¡æœ‰è¢«å–æ¶ˆè®¾ç½®ï¼Œå¯¼è‡´åœ¨è§†å›¾é‡æ–°å‡ºç°æ—¶é‡æ–°æ˜¾ç¤ºè­¦æŠ¥ã€‚</p>
<p>è¿™ä¸ªå±å¹•ä¸­çš„å¦ä¸€ä¸ªç»‘å®šä¹Ÿå¯ä»¥æ›´æ–°ä¸ºæ–°æ ·å¼ã€‚</p>
<pre><code class="language-swift">.sheet(
  isPresented: self.viewStore.binding(
    get: \.isPrimeModalShown,
    send: Action.primeModalDismissed
  )
) {
</code></pre>
<p>è¿™äº›åŠ©æ‰‹å¯ä»¥ç”¨äºæ›´å¤šçš„æƒ…å†µä¸‹ï¼Œä¸åªæ˜¯æ˜¾ç¤ºæé†’ï¼Œå¼¹å‡ºçª—å£å’Œæ¨¡å¼ã€‚æœ‰è®¸å¤šSwiftUIç»„ä»¶æ˜¯ç”±ç»‘å®šé©±åŠ¨çš„ï¼Œä¾‹å¦‚æ–‡æœ¬å­—æ®µã€å¼€å…³ã€é€‰æ‹©å™¨ã€æ»‘åŠ¨å™¨ã€æ­¥è¿›å™¨ã€æ ‡ç­¾æ ï¼Œç”šè‡³å¯¼èˆªé“¾æ¥ã€‚é€šè¿‡ä½¿ç”¨è¿™ä¸ªç»‘å®šåŠ©æ‰‹ï¼Œæ‰€æœ‰è¿™äº›ç»„ä»¶éƒ½å¯ä»¥ä¸å¯ç»„åˆä½“ç³»ç»“æ„æ­£ç¡®é›†æˆã€‚</p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://kayouyou.github.io/tag/i-r9uoo_2N/" class="tag">
                    PointFree
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://kayouyou.github.io/post/pointfree-episode-98ergonomic-state-management-part-1/">
                  <h3 class="post-title">
                    PointFree Episode 98:Ergonomic State Management: Part 1
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
</html>
