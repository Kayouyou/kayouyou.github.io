<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Using SpriteKit to create animations in Swift | Kayouyou&#39;s Den</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://e.coding.net/kayouyou/kayouyoublog/KayouyouBlog.git/favicon.ico?v=1645866598831">
<link rel="stylesheet" href="https://e.coding.net/kayouyou/kayouyoublog/KayouyouBlog.git/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="åŠ¨ç”»æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹å¼æ¥è§£é‡Šæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„åŠŸèƒ½é€šè¿‡è¿åŠ¨ï¼Œå¹¶å–æ‚¦æˆ‘ä»¬çš„ç”¨æˆ·ã€‚åœ¨åˆé€‚çš„åœ°æ–¹æ·»åŠ åŠ¨ç”»å¯ä»¥è®©UIçœ‹èµ·æ¥æ›´æ¼‚äº®ã€‚
ä½†åˆ›é€ ä¼˜ç§€çš„åŠ¨ç”»éœ€è¦è¿›è¡Œå¤§é‡è°ƒæ•´å’Œè¿­ä»£ï¼Œå› ä¸ºæˆ‘ä»¬ç»å¸¸éœ€è¦å°è¯•ä¸åŒçš„åŠ¨ç”»æ­¥éª¤ã€æŒç»­æ—¶é—´å’Œæ›²çº¿ï¼Œä»è€Œè®©ä¸€åˆ‡çœ‹èµ·æ¥æ›´å®Œç¾ã€‚
è¿™..." />
    <meta name="keywords" content="spritekit,animations" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://e.coding.net/kayouyou/kayouyoublog/KayouyouBlog.git">
        <img src="https://e.coding.net/kayouyou/kayouyoublog/KayouyouBlog.git/images/avatar.png?v=1645866598831" class="site-logo">
        <h1 class="site-title">Kayouyou&#39;s Den</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      The wise build bridges, while the foolish build barriers.
    </div>
    <div class="site-footer">
      è±«ICPå¤‡2021012281å·-1  | <a class="rss" href="https://e.coding.net/kayouyou/kayouyoublog/KayouyouBlog.git/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Using SpriteKit to create animations in Swift</h2>
            <div class="post-date">2017-06-25</div>
            
            <div class="post-content" v-pre>
              <p>åŠ¨ç”»æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹å¼æ¥è§£é‡Šæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„åŠŸèƒ½é€šè¿‡è¿åŠ¨ï¼Œå¹¶å–æ‚¦æˆ‘ä»¬çš„ç”¨æˆ·ã€‚åœ¨åˆé€‚çš„åœ°æ–¹æ·»åŠ åŠ¨ç”»å¯ä»¥è®©UIçœ‹èµ·æ¥æ›´æ¼‚äº®ã€‚</p>
<p>ä½†åˆ›é€ ä¼˜ç§€çš„åŠ¨ç”»éœ€è¦è¿›è¡Œå¤§é‡è°ƒæ•´å’Œè¿­ä»£ï¼Œå› ä¸ºæˆ‘ä»¬ç»å¸¸éœ€è¦å°è¯•ä¸åŒçš„åŠ¨ç”»æ­¥éª¤ã€æŒç»­æ—¶é—´å’Œæ›²çº¿ï¼Œä»è€Œè®©ä¸€åˆ‡çœ‹èµ·æ¥æ›´å®Œç¾ã€‚</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½¿ç”¨èƒ½å¤Ÿè®©æˆ‘ä»¬è½»æ¾æ”¹å˜äº‹ç‰©å’Œè°ƒæ•´å‚æ•°çš„å·¥å…·æ¥åˆ›å»ºåŠ¨ç”»æ˜¯å¦‚æ­¤é‡è¦ã€‚æœ¬å‘¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹SpriteKitæ˜¯å¦‚ä½•ä½œä¸ºä¸€ç§ç‰¹å®šç±»å‹åŠ¨ç”»çš„å·¥å…·ã€‚</p>
<h2 id="the-basics">The basics</h2>
<p>SpriteKitæ˜¯è‹¹æœç”¨äº2Dæ¸¸æˆå¼€å‘çš„å†…ç½®æ¡†æ¶(è‡ªiOS 7ä»¥æ¥)ã€‚ æ‰€ä»¥è™½ç„¶å®ƒçš„ä¸»è¦ç›®æ ‡æ˜¯åˆ¶ä½œæ¸¸æˆï¼Œä½†å®ƒä¹Ÿæ˜¯ä»»ä½•2Dç»˜å›¾å’ŒåŠ¨ç”»çš„å¥½å·¥å…·ã€‚äº‹å®ä¸Šï¼Œåœ¨2017å¹´çš„WWDCå¤§ä¼šä¸Šï¼Œè‹¹æœé€éœ²ä»–ä»¬æ­£åœ¨ä½¿ç”¨SpriteKitä¸ºXcodeçš„å†…å­˜è°ƒè¯•å™¨æ„å»ºUIã€‚</p>
<p>å¯¹äºåŠ¨ç”»æ¥è¯´ï¼ŒSpriteKitåœ¨æ„å»ºæ›´å¤æ‚ã€ç‹¬ç«‹çš„åœºæ™¯æ—¶éå¸¸æœ‰ç”¨ã€‚ ä¾‹å¦‚ï¼Œå½“ä½ æ­£åœ¨åˆ›å»ºæŸç§å½¢å¼çš„å…¨å±åŠ è½½åŠ¨ç”»æ—¶ï¼Œä¸€ä¸ªæ’å›¾ä½œä¸ºä½ çš„å…¥èŒæµç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œæˆ–ä»»ä½•å…¶ä»–åŒ…æ‹¬å¤šä¸ªåŠ¨ç”»æ­¥éª¤ï¼Œä½†ä¸ç›´æ¥æ¶‰åŠåŠ¨ç”»è§†å›¾å’ŒUIæ§ä»¶çš„ä¸œè¥¿ã€‚</p>
<p>ä½œä¸ºä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å°†å»ºç«‹ä¸€ä¸ªåŠ è½½åŠ¨ç”»åŒ…å«4ä¸ªè¡¨æƒ…ç¬¦å·ï¼Œè¿™å°†çœ‹èµ·æ¥åƒè¿™æ ·</p>
<h2 id="setting-the-scene">Setting the scene</h2>
<p>æ‰€æœ‰SpriteKitå†…å®¹éƒ½å‘ˆç°åœ¨ä¸€ä¸ªåœºæ™¯ä¸­ï¼Œç”±ä¸€ä¸ªSKSceneç±»çš„å®ä¾‹ç®¡ç†ã€‚ç„¶åä½¿ç”¨åŸºäºèŠ‚ç‚¹çš„ç³»ç»Ÿå®šä¹‰å†…å®¹ï¼Œè¯¥ç³»ç»Ÿå…è®¸æ‚¨åˆ›å»ºå±‚æ¬¡ç»“æ„ï¼Œ å°±åƒä½¿ç”¨uiviewæˆ–CALayersä¸€æ ·ã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨SKNodeçš„å„ç§å­ç±»åˆ›å»ºèŠ‚ç‚¹ï¼Œ ä¾‹å¦‚ï¼ŒSKSpriteNodeç”¨äºåŸºäºsprite(å›¾åƒ)çš„å†…å®¹ï¼ŒSKLabelNodeç”¨äºæ–‡æœ¬å†…å®¹ã€‚æœ€åï¼Œä½ ä½¿ç”¨action(ç”±SKActionç±»è¡¨ç¤º)è®©ä½ çš„èŠ‚ç‚¹åœ¨åœºæ™¯ä¸­æ‰§è¡Œå„ç§åŠ¨ç”»(å¦‚ç§»åŠ¨ã€ç¼©æ”¾ã€æ—‹è½¬ç­‰)ã€‚</p>
<h2 id="getting-started">Getting started</h2>
<p>è®©æˆ‘ä»¬å¼€å§‹åˆ›å»ºä¸€ä¸ªSKSceneä½œä¸ºæˆ‘ä»¬çš„åŠ¨ç”»çš„å®¹å™¨ã€‚æˆ‘ä»¬ç»™å®ƒä¸€ä¸ªä»è§†å›¾æ§åˆ¶å™¨è§†å›¾çš„æœ€å°å°ºå¯¸ä¸­å–æ¥çš„æ­£æ–¹å½¢å¤§å°ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªç™½è‰²çš„èƒŒæ™¯é¢œè‰²:</p>
<pre><code class="language-swift">extension AnimationViewController {
    func makeScene() -&gt; SKScene {
        let minimumDimension = min(view.frame.width, view.frame.height)
        let size = CGSize(width: minimumDimension, height: minimumDimension)

        let scene = SKScene(size: size)
        scene.backgroundColor = .white
        return scene
    }
}
</code></pre>
<p>ä½ ä½¿ç”¨SKView(å®ƒæ˜¯iOSä¸Šçš„UIViewå­ç±»)æ¥å‘ˆç°ä¸€ä¸ªSKSceneã€‚ æˆ‘ä»¬ä¼šæŠŠè¿™æ ·çš„è§†å›¾æ·»åŠ åˆ°è§†å›¾æ§åˆ¶å™¨ï¼Œå¹¶è®¾ç½®å®ƒçš„å¤§å°å’Œä¸­å¿ƒç‚¹ã€‚æœ€åï¼Œæˆ‘ä»¬è®©å®ƒå‘ˆç°æˆ‘ä»¬çš„åœºæ™¯ï¼Œåƒè¿™æ ·:</p>
<pre><code class="language-swift">class AnimationViewController: UIViewController {
    private lazy var animationView = SKView()

    override func loadView() {
        super.loadView()
        view.addSubview(animationView)
    }

    override func viewWillAppear(_ animated: Bool) {
        super.viewWillAppear(animated)

        // Make sure we don't recreate the scene when the view re-appears
        guard animationView.scene == nil else {
            return
        }

        let scene = makeScene()
        animationView.frame.size = scene.size
        animationView.presentScene(scene)
    }

    override func viewDidLayoutSubviews() {
        super.viewDidLayoutSubviews()

        animationView.center.x = view.bounds.midX
        animationView.center.y = view.bounds.midY
    }
}
</code></pre>
<h2 id="adding-nodes">Adding nodes</h2>
<p>æ‰€ä»¥æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªè¦æ¸²æŸ“çš„åœºæ™¯ï¼Œå’Œä¸€ä¸ªä¼šåœ¨è§†å›¾æ§åˆ¶å™¨ä¸­å‘ˆç°å®ƒçš„è§†å›¾ã€‚ è®©æˆ‘ä»¬å¼€å§‹æ·»åŠ ä¸€äº›å†…å®¹ã€‚å¦‚æœæ‚¨ä½¿ç”¨å…³é”®å¸§æ¥æ¸²æŸ“å›¾åƒå’ŒåŠ¨ç”»ï¼Œé‚£ä¹ˆæ‚¨åº”è¯¥ä½¿ç”¨SKSpriteNodeæ¥è¿›è¡Œæ¸²æŸ“ã€‚ä½†åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨ä¸€äº›ç®€å•çš„è¡¨æƒ…ç¬¦å·ï¼Œå› æ­¤æˆ‘ä»¬å°†ä½¿ç”¨SKLabelNode(è¿™åŸºæœ¬ä¸Šæ˜¯SpriteKitçš„UILabel)ã€‚</p>
<p>è®©æˆ‘ä»¬å…ˆåœ¨SKLabelNodeä¸Šåˆ›å»ºä¸€ä¸ªæ‰©å±•ï¼Œå®ƒå…è®¸æˆ‘ä»¬æ¸²æŸ“ä¸€ä¸ªè¡¨æƒ…ç¬¦å·:</p>
<pre><code class="language-swift">extension SKLabelNode {
    func renderEmoji(_ emoji: Character) {
        fontSize = 50
        text = String(emoji)

        // This enables us to move the label using its center point
        verticalAlignmentMode = .center
        horizontalAlignmentMode = .center
    }
}
</code></pre>
<p>ç„¶åï¼Œæˆ‘ä»¬å°†åœ¨è§†å›¾æ§åˆ¶å™¨ä¸Šåˆ›å»ºå¦ä¸€ä¸ªæ‰©å±•æ–¹æ³•æ¥æ·»åŠ åœºæ™¯ä¸­çš„æ‰€æœ‰è¡¨æƒ…ç¬¦å·(æˆ‘ä»¬å°†ä»makeScene()è°ƒç”¨):</p>
<pre><code class="language-swift">extension AnimationViewController {
    func addEmoji(to scene: SKScene) {
        let allEmoji: [Character] = [&quot;ğŸŒ¯&quot;, &quot;ğŸŒ®&quot;, &quot;ğŸ”&quot;, &quot;ğŸ•&quot;]
        let distance = floor(scene.size.width / 4)

        for (index, emoji) in allEmoji.enumerated() {
            let node = SKLabelNode()
            node.renderEmoji(emoji)
            node.position.y = floor(scene.size.height / 2)
            node.position.x = distance * (CGFloat(index) + 0.5)
            scene.addChild(node)
        }
    }
}
</code></pre>
<h2 id="lets-animate">Letâ€™s animate!</h2>
<p>æ‰€æœ‰çš„è®¾ç½®å‡ºæ¥çš„æ–¹å¼ï¼Œè®©æˆ‘ä»¬è¿›å…¥æœ‰è¶£çš„éƒ¨åˆ†-å®é™…åˆ›å»ºæˆ‘ä»¬çš„åŠ¨ç”»ã€‚ æˆ‘ä»¬å°†é€šè¿‡å‘Šè¯‰æ¯ä¸ªè¡¨æƒ…èŠ‚ç‚¹æ”¾å¤§ç„¶åç¼©å°æ¥æ‰§è¡ŒåŠ¨ç”»ï¼Œæ ¹æ®èŠ‚ç‚¹çš„ç´¢å¼•æœ‰è½»å¾®çš„å»¶è¿Ÿ:</p>
<pre><code class="language-swift">func animateNodes(_ nodes: [SKNode]) {
        for (index, node) in nodes.enumerated() {
            // Offset each node with a slight delay depending on the index
            let delayAction = SKAction.wait(forDuration: TimeInterval(index) * 0.2)

            // Scale up and then back down
            let scaleUpAction = SKAction.scale(to: 1.5, duration: 0.3)
            let scaleDownAction = SKAction.scale(to: 1, duration: 0.3)

            // Wait for 2 seconds before repeating the action
            let waitAction = SKAction.wait(forDuration: 2)

            // Form a sequence with the scale actions, as well as the wait action
            let scaleActionSequence = SKAction.sequence([scaleUpAction, scaleDownAction, waitAction])

            // Form a repeat action with the sequence
            let repeatAction = SKAction.repeatForever(scaleActionSequence)

            // Combine the delay and the repeat actions into another sequence
            let actionSequence = SKAction.sequence([delayAction, repeatAction])

            // Run the action
            node.run(actionSequence)
        }
    }

</code></pre>
<p>ä¸Šé¢çš„ä»£ç å¯ä»¥å·¥ä½œï¼Œä½†æ˜¯å¾ˆéš¾é˜…è¯»å’Œæ¨ç†ï¼Œç‰¹åˆ«æ˜¯å¦‚æœæˆ‘ä»¬è¦å»æ‰æ³¨é‡Šã€‚ä½†å¥½æ¶ˆæ¯æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°è§£å†³å®ƒ!  å¤šäºäº†Swiftçš„ç‚¹è¡¨ç¤ºæ³•ï¼Œæˆ‘ä»¬å¯ä»¥æå¤§åœ°å‡å°‘ä»£ç çš„å†—é•¿ï¼Œå¹¶æ¶ˆé™¤æ‰€æœ‰ä¸´æ—¶letèµ‹å€¼:</p>
<pre><code class="language-swift">extension AnimationViewController {
    func animateNodes(_ nodes: [SKNode]) {
        for (index, node) in nodes.enumerated() {
            node.run(.sequence([
                .wait(forDuration: TimeInterval(index) * 0.2),
                .repeatForever(.sequence([
                    .scale(to: 1.5, duration: 0.3),
                    .scale(to: 1, duration: 0.3),
                    .wait(forDuration: 2)
                ]))
            ]))
        }
    }
}
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨makecene()ä¸­çš„æ‰€æœ‰åœºæ™¯èŠ‚ç‚¹æ¥å¼€å§‹æˆ‘ä»¬çš„åŠ¨ç”»:</p>
<pre><code class="language-swift">animateNodes(scene.children)
</code></pre>
<h2 id="with-a-twist">With a twist</h2>
<p>ç°åœ¨æˆ‘ä»¬æœ‰äº†å®¹æ˜“é˜…è¯»(å’Œéå¸¸å£°æ˜æ€§)çš„åŠ¨ç”»ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹ä½¿ç”¨å®ƒäº†ã€‚å‡è®¾æˆ‘ä»¬æƒ³è¦ç»™æˆ‘ä»¬çš„åŠ¨ç”»æ·»åŠ ä¸€ç‚¹æ‰­æ›²(å­—é¢ä¸Šçš„!)ï¼Œé€šè¿‡è®©æˆ‘ä»¬çš„è¡¨æƒ…ç¬¦å·åœ¨ç¼©æ”¾çš„åŒæ—¶æ—‹è½¬360åº¦ã€‚</p>
<p>æˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯å°†ç¼©æ”¾åŠ¨ä½œå’Œæ—‹è½¬åŠ¨ä½œç»„åˆæˆä¸€ä¸ªç»„ï¼Œå°±åƒè¿™æ ·:</p>
<pre><code class="language-swift">extension AnimationViewController {
    func animateNodes(_ nodes: [SKNode]) {
        for (index, node) in nodes.enumerated() {
            node.run(.sequence([
                .wait(forDuration: TimeInterval(index) * 0.2),
                .repeatForever(.sequence([
                    // A group of actions get performed simultaneously
                    .group([
                        .sequence([
                            .scale(to: 1.5, duration: 0.3),
                            .scale(to: 1, duration: 0.3)
                        ]),
                        // Rotate by 360 degrees (pi * 2 in radians)
                        .rotate(byAngle: .pi * 2, duration: 0.6)
                    ]),
                    .wait(forDuration: 2)
                ]))
            ]))
        }
    }
}
</code></pre>
<p>Which will give us the following result:</p>
<h2 id="conclusion">Conclusion</h2>
<p>æ­£å¦‚ä½ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æ‰€çœ‹åˆ°çš„ï¼Œä½¿ç”¨SpriteKitåˆ¶ä½œåŠ¨ç”»èƒ½å¤Ÿè®©æˆ‘ä»¬ç¼–å†™éå¸¸å…·æœ‰å£°æ˜æ€§çš„åŠ¨ç”»ä»£ç ï¼Œä»è€Œæ›´å®¹æ˜“æ”¹å˜ã€æ‰©å±•å’Œè¯•éªŒã€‚å¯¹äºåŠ¨ç”»æ¥è¯´ï¼Œè¿™ç»å¯¹ä¸æ˜¯ä¸€ä¸ªé“¶å¼¹ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰åŠæ³•ä»¥è¿™ç§æ–¹å¼åŠ¨ç”»ä»»ä½•å½¢å¼çš„uiviewï¼Œä½†å¯¹äºç‹¬ç«‹çš„åŸºäºåœºæ™¯çš„åŠ¨ç”»ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„å·¥å…·ã€‚</p>
<p>å½“ç„¶ï¼ŒSpriteKitçš„å†…å®¹è¿œæ¯”æˆ‘åœ¨è¿™ç¯‡æ–‡ç« ä¸­ä»‹ç»çš„è¦å¤šï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³è®©æˆ‘å†å†™ä¸€ç¯‡æ–‡ç« ï¼Œæ›´æ·±å…¥åœ°ä»‹ç»SpriteKitåŠå…¶åŠŸèƒ½ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚</p>
<p><a href="https://www.swiftbysundell.com/articles/using-spritekit-to-create-animations-in-swift/">åŸæ–‡é“¾æ¥</a></p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://e.coding.net/kayouyou/kayouyoublog/KayouyouBlog.git/tag/CIwLvBbFd/" class="tag">
                    spritekit
                  </a>
                
                  <a href="https://e.coding.net/kayouyou/kayouyoublog/KayouyouBlog.git/tag/nk7gw0vRGQ/" class="tag">
                    animations
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://e.coding.net/kayouyou/kayouyoublog/KayouyouBlog.git/post/exploring-the-new-string-api-in-swift-4/">
                  <h3 class="post-title">
                    Exploring the new String API in Swift 4
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
</html>
