<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Dependency injection using factories in Swift | Kayouyou&#39;s Den</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://kayouyou.github.io/favicon.ico?v=1665922595647">
<link rel="stylesheet" href="https://kayouyou.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="ä¾èµ–æ³¨å…¥æ˜¯æé«˜ä»£ç å¯æµ‹è¯•æ€§çš„å¿…è¦å·¥å…·ã€‚ä¸å…¶è®©å¯¹è±¡åˆ›å»ºå®ƒä»¬è‡ªå·±çš„ä¾èµ–é¡¹æˆ–ä½œä¸ºå•ä¾‹è®¿é—®å®ƒä»¬ï¼Œå®ƒçš„æ€æƒ³æ˜¯ï¼Œä¸€ä¸ªå¯¹è±¡ä¸ºäº†å®Œæˆå®ƒçš„å·¥ä½œæ‰€éœ€è¦çš„ä¸€åˆ‡éƒ½åº”è¯¥ä»å¤–éƒ¨ä¼ å…¥ã€‚è¿™æ—¢ä½¿å®ƒæ›´å®¹æ˜“çœ‹åˆ°ä¸€ä¸ªç»™å®šå¯¹è±¡æœ‰å“ªäº›ç¡®åˆ‡çš„ä¾èµ–é¡¹ï¼Œä¹Ÿä½¿æµ‹è¯•å˜å¾—ç®€å•å¾—å¤šâ€”â€”å› ä¸ºä¾èµ–é¡¹å¯..." />
    <meta name="keywords" content="dependency injection,the factory pattern" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://kayouyou.github.io">
        <img src="https://kayouyou.github.io/images/avatar.png?v=1665922595647" class="site-logo">
        <h1 class="site-title">Kayouyou&#39;s Den</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      The wise build bridges, while the foolish build barriers.
    </div>
    <div class="site-footer">
       <a href="https://beian.miit.gov.cn/">è±«ICPå¤‡2021012281å·-1</a> | <a class="rss" href="https://kayouyou.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Dependency injection using factories in Swift</h2>
            <div class="post-date">2017-11-05</div>
            
            <div class="post-content" v-pre>
              <p>ä¾èµ–æ³¨å…¥æ˜¯æé«˜ä»£ç å¯æµ‹è¯•æ€§çš„å¿…è¦å·¥å…·ã€‚ä¸å…¶è®©å¯¹è±¡åˆ›å»ºå®ƒä»¬è‡ªå·±çš„ä¾èµ–é¡¹æˆ–ä½œä¸ºå•ä¾‹è®¿é—®å®ƒä»¬ï¼Œå®ƒçš„æ€æƒ³æ˜¯ï¼Œä¸€ä¸ªå¯¹è±¡ä¸ºäº†å®Œæˆå®ƒçš„å·¥ä½œæ‰€éœ€è¦çš„ä¸€åˆ‡éƒ½åº”è¯¥ä»å¤–éƒ¨ä¼ å…¥ã€‚è¿™æ—¢ä½¿å®ƒæ›´å®¹æ˜“çœ‹åˆ°ä¸€ä¸ªç»™å®šå¯¹è±¡æœ‰å“ªäº›ç¡®åˆ‡çš„ä¾èµ–é¡¹ï¼Œä¹Ÿä½¿æµ‹è¯•å˜å¾—ç®€å•å¾—å¤šâ€”â€”å› ä¸ºä¾èµ–é¡¹å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæ¥æ•è·å’ŒéªŒè¯çŠ¶æ€å’Œå€¼ã€‚</p>
<p>ç„¶è€Œï¼Œå°½ç®¡ä¾èµ–æ³¨å…¥å¾ˆæœ‰ç”¨ï¼Œä½†å½“åœ¨é¡¹ç›®ä¸­å¹¿æ³›ä½¿ç”¨æ—¶ï¼Œå®ƒä¹Ÿå¯èƒ½æˆä¸ºä¸€ä¸ªç›¸å½“å¤§çš„ç—›ç‚¹ã€‚ éšç€ç»™å®šå¯¹è±¡çš„ä¾èµ–é¡¹æ•°é‡çš„å¢é•¿ï¼Œåˆå§‹åŒ–å®ƒå¯èƒ½ä¼šå˜å¾—ç›¸å½“ç¹çã€‚è®©ä»£ç å˜å¾—å¯æµ‹è¯•æ˜¯ä»¶å¥½äº‹ï¼Œä½†å¦‚æœå®ƒéœ€è¦åƒè¿™æ ·çš„åˆå§‹åŒ–å™¨æˆæœ¬ï¼Œé‚£å°±å¤ªç³Ÿç³•äº†:</p>
<pre><code class="language-swift">class UserManager {
    init(dataLoader: DataLoader, database: Database, cache: Cache,
         keychain: Keychain, tokenManager: TokenManager) {
        ...
    }
}
</code></pre>
<p>æœ¬å‘¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€ç§ä¾èµ–æ³¨å…¥æŠ€æœ¯ï¼Œå®ƒä½¿æˆ‘ä»¬èƒ½å¤Ÿå®ç°å¯æµ‹è¯•æ€§ï¼Œè€Œä¸å¿…å¼ºè¿«æˆ‘ä»¬ç¼–å†™æ­¤ç±»å¤§è§„æ¨¡åˆå§‹åŒ–ç¨‹åºæˆ–å¤æ‚çš„ä¾èµ–ç®¡ç†ä»£ç ã€‚</p>
<h2 id="passing-dependencies-around">Passing dependencies around</h2>
<p>å½“ä½¿ç”¨ä¾èµ–æ³¨å…¥æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šå‡ºç°å¦‚ä¸Šæ‰€è¿°çš„æƒ…å†µï¼Œä¸»è¦åŸå› æ˜¯æˆ‘ä»¬éœ€è¦ä¼ é€’ä¾èµ–ä»¥ä¾¿ä»¥åä½¿ç”¨å®ƒä»¬ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æ­£åœ¨æ„å»ºä¸€ä¸ªæ¶ˆæ¯åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨æ¥æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·çš„æ¶ˆæ¯:</p>
<pre><code class="language-swift">class MessageListViewController: UITableViewController {
    private let loader: MessageLoader

    init(loader: MessageLoader) {
        self.loader = loader
        super.init(nibName: nil, bundle: nil)
    }

    override func viewWillAppear(_ animated: Bool) {
        super.viewWillAppear(animated)

        loader.load { [weak self] messages in
            self?.reloadTableView(with: messages)
        }
    }
}
</code></pre>
<p>æ­£å¦‚ä½ åœ¨ä¸Šé¢çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬ä¾èµ–æ³¨å…¥ä¸€ä¸ªMessageLoaderåˆ°æˆ‘ä»¬çš„MessageListViewControllerï¼Œç„¶åå®ƒç”¨å®ƒæ¥åŠ è½½å®ƒçš„æ•°æ®ã€‚è¿™å¹¶ä¸å¤ªç³Ÿç³•ï¼Œå› ä¸ºæˆ‘ä»¬åªæœ‰ä¸€ä¸ªä¾èµ–é¡¹ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬çš„åˆ—è¡¨è§†å›¾å¯èƒ½ä¸æ˜¯ä¸€ä¸ªæ­»èƒ¡åŒï¼Œè¿™åœ¨æŸç§ç¨‹åº¦ä¸Šå°†è¦æ±‚æˆ‘ä»¬å®ç°å¯¼èˆªåˆ°å¦ä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æƒ³è®©ç”¨æˆ·åœ¨ç‚¹å‡»messagesåˆ—è¡¨ä¸­çš„ä¸€ä¸ªå•å…ƒæ ¼æ—¶èƒ½å¤Ÿå¯¼èˆªåˆ°ä¸€ä¸ªæ–°è§†å›¾ã€‚å¯¹äºæ–°è§†å›¾ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªMessageViewControllerï¼Œå®ƒæ—¢è®©ç”¨æˆ·å®Œæ•´åœ°æŸ¥çœ‹æ¶ˆæ¯ï¼Œä¹Ÿè®©ç”¨æˆ·å›å¤æ¶ˆæ¯ã€‚ä¸ºäº†å¯ç”¨åº”ç­”ç‰¹æ€§ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªMessageSenderç±»ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºæ–°è§†å›¾æ§åˆ¶å™¨æ—¶å°†å®ƒæ³¨å…¥åˆ°å®ƒä¸­ï¼Œåƒè¿™æ ·</p>
<pre><code class="language-swift">override func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
    let message = messages[indexPath.row]
    let viewController = MessageViewController(message: message, sender: sender)
    navigationController?.pushViewController(viewController, animated: true)
}
</code></pre>
<p>é—®é¢˜æ¥äº†ã€‚å› ä¸ºMessageViewControlleréœ€è¦ä¸€ä¸ªMessageSenderçš„å®ä¾‹ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è®©MessageListViewControllerçŸ¥é“è¿™ä¸ªç±»ã€‚ä¸€ç§æ–¹æ³•æ˜¯æŠŠsenderä¹Ÿæ·»åŠ åˆ°åˆ—è¡¨è§†å›¾æ§åˆ¶å™¨çš„åˆå§‹åŒ–å™¨ä¸­:</p>
<pre><code class="language-swift">class MessageListViewController: UITableViewController {
    init(loader: MessageLoader, sender: MessageSender) {
        ...
    }
}
</code></pre>
<p>è™½ç„¶ä¸Šé¢çš„å·¥ä½œï¼Œå®ƒå¼€å§‹æŠŠæˆ‘ä»¬å¼•å‘å¦ä¸€ä¸ªå¤§è§„æ¨¡çš„åˆå§‹åŒ–å™¨ï¼Œå¹¶ä½¿MessageListViewControlleræœ‰ç‚¹éš¾ä»¥ä½¿ç”¨(ä¹Ÿç›¸å½“ä»¤äººå›°æƒ‘ï¼Œä¸ºä»€ä¹ˆåˆ—è¡¨éœ€è¦çŸ¥é“å‘é€è€…åœ¨ç¬¬ä¸€ä¸ªåœ°æ–¹?ğŸ¤”)ã€‚</p>
<p>å¦ä¸€ä¸ªå¯èƒ½çš„è§£å†³æ–¹æ¡ˆ(åœ¨è¿™ç§æƒ…å†µä¸‹éå¸¸å¸¸è§)æ˜¯ä½¿MessageSenderæˆä¸ºä¸€ä¸ªå•ä¾‹ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è½»æ¾åœ°ä»ä»»ä½•åœ°æ–¹è®¿é—®å®ƒï¼Œå¹¶é€šè¿‡ä½¿ç”¨å®ƒçš„å…±äº«å®ä¾‹å°†å®ƒæ³¨å…¥åˆ°MessageViewControllerä¸­:</p>
<pre><code class="language-swift">let viewController = MessageViewController(
    message: message,
    sender: MessageSender.shared
)
</code></pre>
<p>ç„¶è€Œï¼Œå°±åƒæˆ‘ä»¬åœ¨â€œSwiftä¸­é¿å…å•ä¾‹â€ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œå•ä¾‹æ–¹æ³•ä¹Ÿæœ‰ä¸€äº›æ˜æ˜¾çš„ç¼ºç‚¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬é™·å…¥ä¸€ç§éš¾ä»¥ç†è§£çš„æ¶æ„å’Œä¸æ¸…æ¥šçš„ä¾èµ–å…³ç³»çš„æƒ…å†µã€‚</p>
<h2 id="factories-to-the-rescue">Factories to the rescue</h2>
<p>å¦‚æœæˆ‘ä»¬å¯ä»¥è·³è¿‡ä¸Šé¢çš„æ‰€æœ‰è¿™äº›ï¼Œå¹¶ä½¿MessageListViewControllerå®Œå…¨ä¸çŸ¥é“MessageSenderï¼Œä»¥åŠæ‰€æœ‰å…¶ä»–ä»»ä½•åç»­è§†å›¾æ§åˆ¶å™¨å¯èƒ½éœ€è¦çš„ä¾èµ–ï¼Œè¿™ä¸æ˜¯å¾ˆå¥½å—?</p>
<p>å¦‚æœä¸¤è€…éƒ½è¶…çº§æ–¹ä¾¿(ç”šè‡³æ¯”å¼•å…¥å•ä¾‹æ—¶æ›´æ–¹ä¾¿)â€”â€”è€Œä¸”éå¸¸å¹²å‡€â€”â€”å¦‚æœæˆ‘ä»¬å¯ä»¥æœ‰æŸç§å½¢å¼çš„å·¥å‚ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°è¦æ±‚ä¸ºç»™å®šçš„æ¶ˆæ¯åˆ›å»ºä¸€ä¸ªMessageViewControllerï¼Œåƒè¿™æ ·:</p>
<pre><code class="language-swift">let viewController = factory.makeMessageViewController(for: message)
</code></pre>
<p>å°±åƒæˆ‘ä»¬åœ¨â€œä½¿ç”¨å·¥å‚æ¨¡å¼é¿å…Swiftä¸­çš„å…±äº«çŠ¶æ€â€ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œæˆ‘çœŸæ­£å–œæ¬¢å·¥å‚çš„ä¸€ç‚¹æ˜¯ï¼Œå®ƒä»¬ä½¿æ‚¨èƒ½å¤Ÿå®Œå…¨è§£è€¦å¯¹è±¡çš„ä½¿ç”¨å’Œåˆ›å»ºã€‚è¿™ä½¿å¾—è®¸å¤šå¯¹è±¡ä¸å®ƒä»¬çš„ä¾èµ–é¡¹ä¹‹é—´å…·æœ‰éå¸¸æ¾æ•£çš„è€¦åˆå…³ç³»ï¼Œè¿™åœ¨æ‚¨æƒ³è¦é‡æ„æˆ–æ›´æ”¹å†…å®¹çš„æƒ…å†µä¸‹ç¡®å®å¾ˆæœ‰å¸®åŠ©ã€‚</p>
<p><em>So how can we make the above happen?</em></p>
<p>æˆ‘ä»¬é¦–å…ˆä¸ºæˆ‘ä»¬çš„å·¥å‚å®šä¹‰ä¸€ä¸ªåè®®ï¼Œè¿™å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿè½»æ¾åœ°åˆ›å»ºä»»ä½•æˆ‘ä»¬åœ¨åº”ç”¨ä¸­éœ€è¦çš„è§†å›¾æ§åˆ¶å™¨ï¼Œè€Œä¸éœ€è¦çœŸæ­£äº†è§£å®ƒçš„ä¾èµ–é¡¹æˆ–åˆå§‹åŒ–å™¨:</p>
<pre><code class="language-swift">protocol ViewControllerFactory {
    func makeMessageListViewController() -&gt; MessageListViewController
    func makeMessageViewController(for message: Message) -&gt; MessageViewController
}
</code></pre>
<p>ä½†æˆ‘ä»¬ä¸ä¼šå°±æ­¤æ­¢æ­¥ã€‚æˆ‘ä»¬è¿˜ä¼šåˆ›å»ºé¢å¤–çš„å·¥å‚åè®®æ¥åˆ›å»ºè§†å›¾æ§åˆ¶å™¨çš„ä¾èµ–é¡¹ï¼Œå°±åƒè¿™ä¸ªè®©æˆ‘ä»¬ä¸ºåˆ—è¡¨è§†å›¾æ§åˆ¶å™¨åˆ›å»ºä¸€ä¸ªMessageLoader:</p>
<pre><code class="language-swift">protocol MessageLoaderFactory {
    func makeMessageLoader() -&gt; MessageLoader
}
</code></pre>
<h2 id="a-single-dependency">A single dependency</h2>
<p>ä¸€æ—¦æˆ‘ä»¬å»ºç«‹äº†æˆ‘ä»¬çš„å·¥å‚åè®®ï¼Œæˆ‘ä»¬å¯ä»¥å›åˆ°MessageListViewControllerå¹¶é‡æ„å®ƒï¼Œè€Œä¸æ˜¯å–å®ƒä¾èµ–çš„å®ä¾‹-å®ƒç°åœ¨åªæ˜¯å–ä¸€ä¸ªå·¥å‚:</p>
<pre><code class="language-swift">class MessageListViewController: UITableViewController {
    // Here we use protocol composition to create a Factory type that includes
    // all the factory protocols that this view controller needs.
    typealias Factory = MessageLoaderFactory &amp; ViewControllerFactory

    private let factory: Factory
    // We can now lazily create our MessageLoader using the injected factory.
    private lazy var loader = factory.makeMessageLoader()

    init(factory: Factory) {
        self.factory = factory
        super.init(nibName: nil, bundle: nil)
    }
}
</code></pre>
<p>é€šè¿‡ä¸Šé¢çš„æ“ä½œï¼Œæˆ‘ä»¬ç°åœ¨å®Œæˆäº†ä¸¤ä»¶äº‹:é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä¾èµ–åˆ—è¡¨å‡å°‘ä¸ºä¸€ä¸ªå·¥å‚ï¼Œå¹¶ä¸”æˆ‘ä»¬å·²ç»ä¸å†éœ€è¦MessageListViewControlleræ¥æ„ŸçŸ¥MessageViewControllerçš„ä¾èµ–ğŸ‰</p>
<h2 id="a-case-for-a-container">A case for a container</h2>
<p>ç°åœ¨æ˜¯æ—¶å€™å®æ–½æˆ‘ä»¬çš„å·¥å‚åè®®äº†ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰ä¸€ä¸ªDependencyContainerï¼Œå®ƒå°†åŒ…å«æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„æ‰€æœ‰æ ¸å¿ƒå®ç”¨å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡é€šå¸¸ç›´æ¥ä½œä¸ºä¾èµ–é¡¹æ³¨å…¥ã€‚è¿™åŒ…æ‹¬ä»¥å‰çš„MessageSenderï¼Œä¹ŸåŒ…æ‹¬æ›´ä½çº§çš„é€»è¾‘ç±»ï¼Œå¦‚æˆ‘ä»¬å¯èƒ½ä½¿ç”¨çš„ä»»ä½•NetworkManagerã€‚</p>
<pre><code class="language-swift">class DependencyContainer {
    private lazy var messageSender = MessageSender(networkManager: networkManager)
    private lazy var networkManager = NetworkManager(urlSession: .shared)
}
</code></pre>
<p>æ­£å¦‚æ‚¨åœ¨ä¸Šé¢çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨å»¶è¿Ÿå±æ€§æ˜¯ä¸ºäº†åœ¨åˆå§‹åŒ–å¯¹è±¡æ—¶èƒ½å¤Ÿå¼•ç”¨åŒä¸€ä¸ªç±»çš„å…¶ä»–å±æ€§ã€‚è¿™æ˜¯è®¾ç½®ä¾èµ–å…³ç³»å›¾çš„ä¸€ç§éå¸¸æ–¹ä¾¿å’Œå¥½çš„æ–¹æ³•ï¼Œå› ä¸ºæ‚¨å¯ä»¥åˆ©ç”¨ç¼–è¯‘å™¨æ¥å¸®åŠ©æ‚¨é¿å…è¯¸å¦‚å¾ªç¯ä¾èµ–å…³ç³»ä¹‹ç±»çš„é—®é¢˜ã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬å°†ä½¿æˆ‘ä»¬çš„æ–°ä¾èµ–å®¹å™¨ç¬¦åˆæˆ‘ä»¬çš„å·¥å‚åè®®ï¼Œè¿™å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿå°†å®ƒä½œä¸ºä¸€ä¸ªå·¥å‚æ³¨å…¥åˆ°æˆ‘ä»¬çš„å„ç§è§†å›¾æ§åˆ¶å™¨å’Œå…¶ä»–å¯¹è±¡:</p>
<pre><code class="language-swift">extension DependencyContainer: ViewControllerFactory {
    func makeMessageListViewController() -&gt; MessageListViewController {
        return MessageListViewController(factory: self)
    }

    func makeMessageViewController(for message: Message) -&gt; MessageViewController {
        return MessageViewController(message: message, sender: messageSender)
    }
}

extension DependencyContainer: MessageLoaderFactory {
    func makeMessageLoader() -&gt; MessageLoader {
        return MessageLoader(networkManager: networkManager)
    }
}
</code></pre>
<h2 id="distributed-ownership">Distributed ownership</h2>
<p>ç°åœ¨æ˜¯è§£å†³è¿™ä¸ªéš¾é¢˜çš„æœ€åä¸€æ­¥äº†â€”â€”æˆ‘ä»¬å®é™…ä¸Šåœ¨å“ªé‡Œå­˜å‚¨æˆ‘ä»¬çš„ä¾èµ–å®¹å™¨ï¼Œè°åº”è¯¥æ‹¥æœ‰å®ƒï¼Œå®ƒåº”è¯¥åœ¨å“ªé‡Œè®¾ç½®? è¿™é‡Œæœ‰ä¸€ä»¶å¾ˆé…·çš„äº‹æƒ…â€”â€”å› ä¸ºæˆ‘ä»¬å°†æŠŠä¾èµ–å®¹å™¨æ³¨å…¥ä¸ºæˆ‘ä»¬çš„å¯¹è±¡æ‰€éœ€çš„å·¥å‚çš„å®ç°ï¼Œè€Œä¸”å› ä¸ºè¿™äº›å¯¹è±¡å°†æŒæœ‰å¯¹å…¶å·¥å‚çš„å¼ºå¼•ç”¨â€”â€”æˆ‘ä»¬æ²¡æœ‰å¿…è¦å°†å®¹å™¨å­˜å‚¨åœ¨å…¶ä»–ä»»ä½•åœ°æ–¹ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœMessageListViewControlleræ˜¯æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„åˆå§‹è§†å›¾æ§åˆ¶å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°åˆ›å»ºä¸€ä¸ªDependencyContainerå®ä¾‹å¹¶å°†å®ƒä¼ å…¥:</p>
<pre><code class="language-swift">let container = DependencyContainer()
let listViewController = container.makeMessageListViewController()

window.rootViewController = UINavigationController(
    rootViewController: listViewController
)
</code></pre>
<p>ä¸éœ€è¦åœ¨ä»»ä½•åœ°æ–¹ä¿ç•™ä»»ä½•å…¨å±€å˜é‡ï¼Œä¹Ÿä¸éœ€è¦åœ¨åº”ç”¨å§”æ‰˜ä¸­ä½¿ç”¨å¯é€‰å±æ€§ğŸ‘ã€‚</p>
<h2 id="conclusion">Conclusion</h2>
<p>ä½¿ç”¨å·¥å‚åè®®å’Œå®¹å™¨æ¥è®¾ç½®ä¾èµ–é¡¹æ³¨å…¥æ˜¯é¿å…ä¼ é€’å¤šä¸ªä¾èµ–é¡¹å’Œåˆ›å»ºå¤æ‚åˆå§‹åŒ–å™¨çš„å¥½æ–¹æ³•ã€‚è™½ç„¶å®ƒä¸æ˜¯é“¶å¼¹ï¼Œä½†å®ƒå¯ä»¥è®©ä¾èµ–æ³¨å…¥çš„ä½¿ç”¨å˜å¾—æ›´å®¹æ˜“â€”â€”è¿™å°†è®©ä½ æ›´æ¸…æ¥šåœ°äº†è§£å¯¹è±¡çš„å®é™…ä¾èµ–å…³ç³»ï¼ŒåŒæ—¶ä¹Ÿä½¿æµ‹è¯•å˜å¾—æ›´ç®€å•ã€‚</p>
<p>ç”±äºæˆ‘ä»¬å·²ç»å°†æ‰€æœ‰å·¥å‚å®šä¹‰ä¸ºåè®®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°ä»»ä½•ç»™å®šå·¥å‚åè®®çš„ç‰¹å®šäºæµ‹è¯•çš„ç‰ˆæœ¬ï¼Œè½»æ¾åœ°åœ¨æµ‹è¯•ä¸­æ¨¡æ‹Ÿå®ƒä»¬ã€‚æˆ‘å°†åœ¨ä»¥åçš„åšæ–‡ä¸­å†™æ›´å¤šå…³äºmockä»¥åŠå¦‚ä½•åœ¨æµ‹è¯•ä¸­å……åˆ†åˆ©ç”¨ä¾èµ–æ³¨å…¥çš„å†…å®¹ã€‚</p>
<p><a href="https://www.swiftbysundell.com/articles/dependency-injection-using-factories-in-swift/">åŸæ–‡é“¾æ¥</a></p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://kayouyou.github.io/tag/SI7Eu5Vqu/" class="tag">
                    dependency injection
                  </a>
                
                  <a href="https://kayouyou.github.io/tag/r9ICJ5fqlq/" class="tag">
                    the factory pattern
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://kayouyou.github.io/post/using-tokens-to-handle-async-swift-code/">
                  <h3 class="post-title">
                    Using tokens to handle async Swift code
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
</html>
