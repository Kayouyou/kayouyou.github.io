<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Launch arguments in Swift | Kayouyou&#39;s Den</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://kayouyou.github.io/favicon.ico?v=1645876346136">
<link rel="stylesheet" href="https://kayouyou.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="å¯åŠ¨å‚æ•°å¯èƒ½æ˜¯æœ€å¸¸ç”¨çš„å‘½ä»¤è¡Œå·¥å…·çš„è¾“å…¥ã€‚æ— è®ºæ˜¯ä½¿ç”¨mkdiråˆ›å»ºæ–°æ–‡ä»¶å¤¹ï¼Œä½¿ç”¨xcodebuildè¿è¡Œè‡ªå®šä¹‰æ„å»ºï¼Œè¿˜æ˜¯ä½¿ç”¨curl - launchå‚æ•°æ‰§è¡Œç½‘ç»œè¯·æ±‚ï¼Œéƒ½æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼Œå¯ä»¥å°†åŸºäºå­—ç¬¦ä¸²çš„è¾“å…¥ä¼ é€’åˆ°å‘½ä»¤è¡Œç¨‹åºä¸­ã€‚
è™½ç„¶S..." />
    <meta name="keywords" content="scripting,debugging" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://kayouyou.github.io">
        <img src="https://kayouyou.github.io/images/avatar.png?v=1645876346136" class="site-logo">
        <h1 class="site-title">Kayouyou&#39;s Den</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      The wise build bridges, while the foolish build barriers.
    </div>
    <div class="site-footer">
      è±«ICPå¤‡2021012281å·-1  | <a class="rss" href="https://kayouyou.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Launch arguments in Swift</h2>
            <div class="post-date">2018-05-20</div>
            
            <div class="post-content" v-pre>
              <p>å¯åŠ¨å‚æ•°å¯èƒ½æ˜¯æœ€å¸¸ç”¨çš„å‘½ä»¤è¡Œå·¥å…·çš„è¾“å…¥ã€‚æ— è®ºæ˜¯ä½¿ç”¨mkdiråˆ›å»ºæ–°æ–‡ä»¶å¤¹ï¼Œä½¿ç”¨xcodebuildè¿è¡Œè‡ªå®šä¹‰æ„å»ºï¼Œè¿˜æ˜¯ä½¿ç”¨curl - launchå‚æ•°æ‰§è¡Œç½‘ç»œè¯·æ±‚ï¼Œéƒ½æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼Œå¯ä»¥å°†åŸºäºå­—ç¬¦ä¸²çš„è¾“å…¥ä¼ é€’åˆ°å‘½ä»¤è¡Œç¨‹åºä¸­ã€‚</p>
<p>è™½ç„¶Swiftæ˜¯åˆ›å»ºå‘½ä»¤è¡Œå·¥å…·çš„å¥½è¯­è¨€â€”â€”æœ¬å‘¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åœ¨å¼€å‘ã€è°ƒè¯•å’Œæµ‹è¯•ä¸€ä¸ªiOSåº”ç”¨ç¨‹åºæ—¶ä¹Ÿä½¿ç”¨å¯åŠ¨å‚æ•°çš„åŠ›é‡ã€‚</p>
<h2 id="parsing">Parsing</h2>
<p>Swiftæä¾›äº†ä¸¤ç§å†…ç½®æ–¹æ³•æ¥è§£æå¯åŠ¨å‚æ•°ã€‚ ç¬¬ä¸€ä¸ªæ˜¯é€šè¿‡å‘½ä»¤è¡ŒAPIï¼Œå®ƒå¯ä»¥æ–¹ä¾¿åœ°è®¿é—®åœ¨å¯åŠ¨åº”ç”¨ç¨‹åºæ—¶ä¼ é€’çš„ä¿¡æ¯(å³ä½¿åœ¨ä¸é™„å¸¦ç»ˆç«¯çš„iOSå¹³å°ä¸Š)ã€‚ä½¿ç”¨CommandLine.argumentsï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªè¡¨ç¤ºæ¯ä¸ªå‚æ•°çš„å­—ç¬¦ä¸²æ•°ç»„ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨å®ƒæ¥ç¡®å®šæ˜¯å¦åº”è¯¥ä½¿ç”¨ProfileViewControllerçš„æ–°å®ç°:</p>
<pre><code class="language-swift">func makeProfileViewController() -&gt; UIViewController {
    if CommandLine.arguments.contains(&quot;-new-profile&quot;) {
        // If the &quot;-new-profile&quot; argument was passed, then return
        // an instance of the new implementation.
        return ProfileViewController()
    }

    // Fall back to the old implementation, which is what we
    // still use in production.
    return ProfileLegacyViewController()
}
</code></pre>
<p>è™½ç„¶CommandLineæä¾›äº†ä¸€ç§è®¿é—®â€œåŸå§‹â€å‚æ•°çš„ç®€å•æ–¹æ³•ï¼Œä½†å®ƒå®é™…ä¸Šå¹¶æ²¡æœ‰æä¾›ä»»ä½•å¤æ‚çš„è§£æåŠŸèƒ½ã€‚ ä¸ºäº†è·å¾—æ›´å¼ºå¤§çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨UserDefaultsæ¥è§£æå¯åŠ¨å‚æ•°ã€‚</p>
<p>äº‹å®ä¸Šï¼ŒUserDefaultsåŒ…å«æ‰€æœ‰é€šè¿‡å‘½ä»¤è¡Œä¼ é€’çš„å‚æ•°ï¼Œå¹¶ä¸”å¯ä»¥è¿›è¡ŒåŸºæœ¬çš„ç±»å‹è½¬æ¢ï¼Œå¦‚Boolã€Intå’ŒDoubleï¼Œè¿™æ˜¯ä¸€ä¸ªéšè—çš„çå®ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªç‰¹æ€§æ¥è¦†ç›–æ‰§è¡Œä¸€ä¸ªç½‘ç»œè¯·æ±‚æ—¶åº”è¯¥åŠ è½½å¤šå°‘æ–‡ç« :</p>
<pre><code class="language-swift">func loadArticles(then handler: @escaping (Result&lt;[Article]&gt;) -&gt; Void) {
    // The UserDefaults API automatically parses types like integers and
    // doubles from strings passed as launch arguments. In this
    // case we'll treat 0 as &quot;no limit&quot;.
    let limit = UserDefaults.standard.integer(forKey: &quot;article-limit&quot;)
    let endpoint = Endpoint.articleList(limit: limit)

    dataLoader.loadData(from: endpoint) { result in
        handler(result.decoded())
    }
}
</code></pre>
<h2 id="passing">Passing</h2>
<p>ç°åœ¨æˆ‘ä»¬æœ‰äº†åœ¨iOSåº”ç”¨ç¨‹åºä¸­è§£æå‘½ä»¤è¡Œå‚æ•°çš„æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ç§ä¼ é€’å®ƒä»¬çš„æ–¹æ³•ã€‚å½“è¿è¡Œå’Œè°ƒè¯•æ—¶ï¼Œè¿™æ˜¯é€šè¿‡Xcodeå®Œæˆçš„ï¼Œé€šè¿‡æ·»åŠ ä»»ä½•æˆ‘ä»¬æƒ³è¦ä¼ é€’ç»™åº”ç”¨ç¨‹åºæ–¹æ¡ˆçš„å‚æ•°ã€‚ åœ¨Xcodeä¸­è®¿é—®è¿™ä¸ªé€‰é¡¹çš„ä¸€ä¸ªç®€å•æ–¹æ³•æ˜¯æŒ‰âŒ˜âŒ¥Rï¼Œé€‰æ‹©â€œArgumentsâ€å¹¶æ·»åŠ æˆ‘ä»¬çš„å‚æ•°åœ¨â€œArguments Passed On Launchâ€ä¸‹ã€‚</p>
<p>é‚£ä¹ˆå‘èµ·è¾©è®ºæœ‰ä»€ä¹ˆç”¨å‘¢? è®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‰ä¸ªç”¨ä¾‹â€”â€”è°ƒè¯•ã€å¼€å‘æ–°ç‰¹æ€§å’ŒUIæµ‹è¯•ã€‚</p>
<h2 id="debug-actions">Debug actions</h2>
<p>å¯åŠ¨å‚æ•°å¯ä»¥åœ¨è°ƒè¯•åº”ç”¨ç¨‹åºæ—¶æä¾›ä¸€ç§ç®€å•å¿«æ·çš„æ–¹å¼æ¥æ‰§è¡Œå¸¸è§æ“ä½œã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªæ‰§è¡Œå¤§é‡ç½‘ç»œè¯·æ±‚çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”æˆ‘ä»¬æ”¶åˆ°äº†ç”¨æˆ·çš„æŠ¥å‘Šï¼Œè¯¥åº”ç”¨ç¨‹åºåœ¨æ…¢é€Ÿç½‘ç»œä¸Šä½¿ç”¨æ—¶æ€§èƒ½å¾ˆå·®ã€‚</p>
<p>ä¸ºäº†è°ƒè¯•è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³è¦ç»™æ‰€æœ‰çš„ç½‘ç»œè¯·æ±‚æ·»åŠ äººå·¥å»¶è¿Ÿï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è§‚å¯Ÿæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåœ¨è¿™ç§æƒ…å†µä¸‹çš„è¡Œä¸ºã€‚è™½ç„¶iOSæä¾›äº†Linkè°ƒèŠ‚å™¨å·¥å…·ï¼Œè¿™æ˜¯è®¾å¤‡ä¸Šè°ƒè¯•çš„ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œä½†åœ¨å¼€å§‹ä¿®å¤æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›é€šè¿‡ä½¿ç”¨æ¨¡æ‹Ÿå™¨æ¥ç¼©çŸ­è¿­ä»£æ—¶é—´ã€‚</p>
<p>ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªlaunchå‚æ•°æ¥å¢åŠ æ‰€æœ‰ç½‘ç»œè¯·æ±‚çš„å»¶è¿Ÿï¼Œå¦‚ä¸‹æ‰€ç¤º:</p>
<pre><code class="language-swift">class DataLoader {
    private let session: URLSession
    private let userDefaults: UserDefaults

    func loadData(from endpoint: Endpoint,
                  then handler: @escaping (Result&lt;Data&gt;) -&gt; Void) {
        let url = endpoint.url
        let task = makeTask(for: url, handler: handler)

        // If the app is running in debug mode, add a delay
        // according to the &quot;network-delay&quot; launch argument
        #if DEBUG
        let delay = userDefaults.double(forKey: &quot;network-delay&quot;)
        DispatchQueue.main.asyncAfter(deadline: .now() + delay,
                                      execute: task.resume)
        #else
        task.resume()
        #endif
    }
}
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å°†å»¶è¿Ÿä»£ç å°è£…åœ¨#ifè°ƒè¯•ç¼–è¯‘å™¨æ¡ä»¶ä¸­ï¼Œä»¥é˜²æ­¢è¿™æ®µä»£ç æ„å¤–åœ°è¢«å‘é€åˆ°App Storeã€‚è¿™æ ·ï¼Œæˆ‘ä»¬çš„è°ƒè¯•ä»£ç ç”šè‡³ä¸ä¼šåœ¨å‘å¸ƒæ„å»ºæ—¶è¢«ç¼–è¯‘ã€‚</p>
<p>ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ å¯åŠ¨å‚æ•°æ¥æ§åˆ¶åº”ç”¨ç¨‹åºä¸­çš„å…¶ä»–ç±»å‹çš„è°ƒè¯•æ“ä½œâ€”â€”ä¾‹å¦‚;å½“åº”ç”¨å¯åŠ¨æ—¶ï¼Œå¯¼èˆªåˆ°ä¸€ä¸ªç»™å®šçš„å±å¹•ï¼Œæ˜¯å¦åº”ç”¨å†…è´­ä¹°å·²è§£é”ï¼Œæˆ–æ¨¡æ‹Ÿæ¥è‡ªå¥åº·åº”ç”¨ç­‰ä¸œè¥¿çš„æ•°æ®ã€‚</p>
<h2 id="overriding-feature-flags">Overriding feature flags</h2>
<p>å¯åŠ¨å‚æ•°æ´¾ä¸Šç”¨åœºçš„å¦ä¸€ç§æƒ…å†µæ˜¯ï¼Œåœ¨å¼€å‘å°šæœªå®Œå…¨å‘å¸ƒçš„æ–°ç‰¹æ€§æ—¶ã€‚å°±åƒæˆ‘ä»¬åœ¨â€œSwiftä¸­çš„åŠŸèƒ½æ ‡å¿—â€ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œä½¿ç”¨åŠŸèƒ½æ ‡å¿—å¯ä»¥è®©åŠŸèƒ½é€æ­¥å‘ç”¨æˆ·æ¨å‡ºï¼Œå¹¶è¿›è¡Œå®éªŒå’Œa /Bæµ‹è¯•ã€‚</p>
<p>ç„¶è€Œï¼Œå½“å¼€å‘ä¸€æ¬¾ä¸¥é‡ä¾èµ–åŠŸèƒ½æ ‡å¿—çš„åº”ç”¨æ—¶ï¼Œä¸ºäº†èƒ½å¤Ÿå¼€å‘ç‰¹å®šåŠŸèƒ½ï¼Œè®©åº”ç”¨è¿›å…¥æ‰€éœ€çš„ç¡®åˆ‡çŠ¶æ€å¯èƒ½ä¼šèŠ±è´¹ä¸€äº›æ—¶é—´å’ŒæŠ€å·§ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å…¥launchå‚æ•°ï¼Œè®©æˆ‘ä»¬å¯ä»¥ä¸ºé€šå¸¸ä»æœåŠ¡å™¨åŠ¨æ€è·å–å€¼çš„ç‰¹æ€§æ ‡è®°æ·»åŠ æœ¬åœ°è¦†ç›–:</p>
<pre><code class="language-swift">func enableSearchIfNeeded() {
    var override: Bool?
    let key = &quot;search&quot;

    // We first check if the argument was actually passed, before
    // asking UserDefaults to convert it into a Bool, otherwise
    // the dynamic value will never be used.
    #if DEBUG
    if userDefaults.value(forKey: key) != nil {
        override = userDefaults.bool(forKey: key)
    }
    #endif

    if override ?? featureFlags.searchEnabled {
        enableSearch()
    }
}
</code></pre>
<p>è™½ç„¶ä¸Šé¢çš„ä»£ç æ˜¯ç‰¹å®šäºæœç´¢ç‰¹æ€§çš„ï¼Œä½†æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°å°†å®ƒæ™®éåŒ–ï¼Œä½¿å…¶é€‚ç”¨äºä»»ä½•ç‰¹æ€§æ ‡å¿—ï¼Œå¹¶åœ¨å…±äº«ä»£ç è·¯å¾„ä¸­è°ƒç”¨å®ƒâ€”â€”ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬ä»æœåŠ¡å™¨åŠ è½½å€¼æ—¶ã€‚</p>
<h2 id="setting-state">Setting state</h2>
<p>é€šå¸¸åœ¨è°ƒè¯•æˆ–æµ‹è¯•åº”ç”¨æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶ç½®äºç‰¹å®šçŠ¶æ€ï¼Œä»¥ä¾¿é‡ç°æ¼æ´æˆ–ä½¿ç”¨ç‰¹å®šåŠŸèƒ½ã€‚è¿™æ˜¯ä¸€ä»¶ç»å¸¸é‡å¤çš„äº‹æƒ…(è€Œä¸”æœ‰ç‚¹çƒ¦äºº)ï¼Œå½“å·¥ä½œæ—¶å¿…é¡»ä¸€éåˆä¸€éåœ°åšâ€”â€”æ‰€ä»¥è®©æˆ‘ä»¬ä½¿ç”¨å¯åŠ¨å‚æ•°æ¥è‡ªåŠ¨åŒ–å®ƒ!</p>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ¥å®Œå…¨é‡ç½®æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚å½“ç„¶ï¼Œè¿™å¯ä»¥é€šè¿‡æ‰‹åŠ¨å¸è½½åº”ç”¨ç¨‹åºæ¥å®Œæˆï¼Œä½†å¦‚æœåœ¨è¿è¡Œåº”ç”¨ç¨‹åºæ—¶ç®€å•åœ°ä¼ é€’ä¸€ä¸ª-resetå‚æ•°ï¼Œè®©å®ƒåœ¨ç©ºç™½çŠ¶æ€ä¸‹å¯åŠ¨ï¼Œä¼šå®¹æ˜“å¾—å¤šã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªresetIfNeeded()æ–¹æ³•ï¼Œå½“åº”ç”¨å¯åŠ¨æ—¶ï¼Œæˆ‘ä»¬ä¼šä»AppDelegateä¸­è°ƒç”¨å®ƒï¼Œå°±åƒè¿™æ ·:</p>
<pre><code class="language-swift">extension AppDelegate {
    func resetIfNeeded() {
        guard CommandLine.arguments.contains(&quot;-reset&quot;) else {
            return
        }

        // We can reset our user defaults by removing the persistance
        // for our app's bundle identifier
        let defaultsName = Bundle.main.bundleIdentifier!
        userDefaults.removePersistentDomain(forName: defaultsName)

        // Reset any caching mechanisms, databases, etc.
        cache.reset()
        database.reset()
    }
}
</code></pre>
<p>ç±»ä¼¼åœ°ï¼Œå®ƒä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œä¸ä»…èƒ½å¤Ÿé‡ç½®åº”ç”¨ç¨‹åºï¼Œè¿˜èƒ½ä½¿å®ƒè¢«æ”¾ç½®åˆ°ç‰¹å®šçš„åˆå§‹çŠ¶æ€ã€‚å‡è®¾æˆ‘ä»¬æ­£åœ¨æ„å»ºä¸€ä¸ªåŒ…å«ç”¨æˆ·è”ç³»äººåˆ—è¡¨çš„åº”ç”¨ç¨‹åºã€‚ä½¿ç”¨å¯åŠ¨å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æä¾›ä¸€ç§å¿«é€Ÿçš„æ–¹æ³•ï¼Œç”¨ç»™å®šçš„å§“ååˆ—è¡¨é¢„å¡«å……è”ç³»äººæ•°æ®åº“(åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨é€—å·åˆ†éš”çš„åˆ—è¡¨ä½œä¸ºè¾“å…¥æ ¼å¼):</p>
<pre><code class="language-swift">extension ContactsManager {
    func addNamesFromCommandLine() {
        guard let argument = userDefaults.string(forKey: &quot;contacts&quot;) else {
            return
        }

        let names = argument.components(separatedBy: &quot;,&quot;)
        names.forEach(add)
    }
}
</code></pre>
<h2 id="containment">Containment</h2>
<p>åœ¨åšä¸Šè¿°æ‰€æœ‰å·¥ä½œæ—¶ï¼Œæˆ‘ä»¬æ‰€å…³å¿ƒçš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬ç°åœ¨å¦‚ä½•å°†å¤§é‡çš„è°ƒè¯•å’Œæµ‹è¯•ä»£ç åˆ†æ•£åœ¨æˆ‘ä»¬çš„å¸¸è§„åº”ç”¨ä»£ç ä¸­ã€‚</p>
<p>è™½ç„¶æ·»åŠ ä¸“é—¨ç”¨äºè°ƒè¯•çš„ä»£ç ä¸ä¸€å®šæ˜¯ä»¶åäº‹(æ¯•ç«Ÿï¼Œæˆ‘ä»¬çš„ä»£ç åº“æœ‰ç‚¹åƒæˆ‘ä»¬çš„â€œæ•°å­—å·¥ä½œåœºæ‰€â€)ï¼Œä½†å¦‚æœæˆ‘ä»¬èƒ½å°†æ‰€æœ‰ä»£ç éƒ½åŒ…å«åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œè€Œä¸æ˜¯å°†å…¶åˆ†æ•£åˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ï¼Œé‚£å°±æ›´å¥½äº†ã€‚è¿™æ ·æˆ‘ä»¬å°±èƒ½æ›´å¥½åœ°æ§åˆ¶æˆ‘ä»¬å®é™…æ‹¥æœ‰çš„è°ƒè¯•ä»£ç ï¼Œå¹¶ä¸”æ›´å®¹æ˜“é˜²æ­¢è¿™äº›ä»£ç æ„å¤–åœ°è¿›å…¥å‘å¸ƒç‰ˆæœ¬ã€‚</p>
<p>ä¸€ç§æ–¹æ³•æ˜¯å°†æ‰€æœ‰ä¸å¯åŠ¨å‚æ•°ç›¸å…³çš„ä»£ç ç§»åŠ¨åˆ°ä¸“ç”¨ç±»å‹ä¸­ã€‚ ä½œä¸ºä¸€ä¸ªä¾‹å­ï¼Œè¿™é‡Œæ˜¯æˆ‘ä»¬å¦‚ä½•ç§»åŠ¨æˆ‘ä»¬çš„è¡ŒåŠ¨ï¼Œé‡ç½®ï¼Œå»¶è¿Ÿç½‘ç»œè¯·æ±‚å’Œæ·»åŠ æ¨¡æ‹Ÿè”ç³»äººåˆ°ä¸€ä¸ªå•ç‹¬çš„ï¼ŒåŒ…å«LaunchArgumentsHandler:</p>
<pre><code class="language-swift">struct LaunchArgumentsHandler {
    let userDefaults: UserDefaults
    let contactsManager: ContactsManager
    let dataLoader: DataLoader
    let cache: Cache
    let database: Database

    func handle() {
        resetIfNeeded()
        addNetworkDelayIfNeeded()
        addContactsIfNeeded()
    }

    private func resetIfNeeded() {
        guard CommandLine.arguments.contains(&quot;-reset&quot;) else {
            return
        }

        let defaultsName = Bundle.main.bundleIdentifier!
        userDefaults.removePersistentDomain(forName: defaultsName)

        cache.reset()
        database.reset()
    }

    private func addNetworkDelayIfNeeded() {
        let delay = userDefaults.double(forKey: &quot;network-delay&quot;)

        guard delay &gt; 0 else {
            return
        }

        // We've abstracted the delaying of data loader tasks  
        // into an &quot;executor&quot; closure, leaving our production
        // code free of any delaying code.
        dataLoader.taskExecutor = { task in
            DispatchQueue.main.asyncAfter(deadline: .now() + delay,
                                          execute: task.resume)
        }
    }

    private func addContactsIfNeeded() {
        guard let argument = userDefaults.string(forKey: &quot;contacts&quot;) else {
            return
        }

        let names = argument.components(separatedBy: &quot;,&quot;)
        names.forEach(contactsManager.add)
    }
}
</code></pre>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸ä¹‹å‰ç›¸åŒçš„#ifè°ƒè¯•æ¡ä»¶æ¥å°è£…ä¸Šé¢çš„LaunchArgumentsHandlerå£°æ˜ï¼Œæˆ–è€…å¦‚æœæˆ‘ä»¬åœ¨è°ƒè¯•/åˆ†æ®µæ„å»ºå’Œå‘å¸ƒæ„å»ºä¸­ä½¿ç”¨å•ç‹¬çš„Xcodeç›®æ ‡â€”â€”æˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä»ç”Ÿäº§ç›®æ ‡ä¸­æ’é™¤LaunchArgumentsHandler.swiftæ–‡ä»¶ã€‚</p>
<p>é€šè¿‡è¿™æ ·åšï¼Œæˆ‘ä»¬ç°åœ¨å¯¹å¯ç”¨çš„å¯åŠ¨å‚æ•°æ“ä½œæœ‰äº†æ›´æ¸…æ™°çš„æ¦‚è¿°ï¼Œåœ¨å‘å¸ƒç‰ˆæœ¬æ—¶ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªç¼–è¯‘é”™è¯¯ï¼Œä»¥é˜²æˆ‘ä»¬æ— æ„ä¸­ä½¿ç”¨äº†ä¸å±äºå®ƒçš„è°ƒè¯•ä»£ç ã€‚</p>
<p>æˆ‘ä»¬ç°åœ¨è¦åšçš„å°±æ˜¯åœ¨æˆ‘ä»¬è®¾ç½®å¥½æˆ‘ä»¬çš„åº”ç”¨ç¨‹åº(ä¾‹å¦‚åœ¨AppDelegateä¸­)ä¹‹åè°ƒç”¨LaunchArgumentsHandlerï¼Œå¹¶ç”¨#if DEBUGåŒ…å›´è¿™ä¸ªè°ƒç”¨ï¼Œä½¿å®ƒåœ¨æ‰€æœ‰æ¡ä»¶ä¸‹éƒ½èƒ½æ­£ç¡®ç¼–è¯‘ğŸ‘ã€‚</p>
<h2 id="conclusion">Conclusion</h2>
<p>å¯åŠ¨å‚æ•°å¯ä»¥æä¾›ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥è®¾ç½®çœŸæ­£æœ‰ç”¨çš„è°ƒè¯•å’Œæ¨¡æ‹Ÿæ“ä½œï¼Œè¿™æœ‰åŠ©äºåŠ é€Ÿæˆ‘ä»¬çš„å¼€å‘å’Œæµ‹è¯•ã€‚ é€šè¿‡æ·»åŠ å¯åŠ¨å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿè¿›å…¥æˆ‘ä»¬æƒ³è¦çš„çŠ¶æ€ï¼Œæˆ–åœ¨æ¯æ¬¡å¯åŠ¨æ—¶å®Œå…¨é‡ç½®åº”ç”¨ï¼Œä»è€Œæ— éœ€æ¯æ¬¡è¿è¡Œåº”ç”¨æ—¶æ‰‹åŠ¨è®¾ç½®è¿™äº›å†…å®¹ã€‚</p>
<p>è™½ç„¶æ·»åŠ è¿™ç±»è°ƒè¯•æ“ä½œè‚¯å®šä¼šæœ‰é£é™©â€”â€”å› ä¸ºæˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºä¸­å¼•å…¥äº†æ›´å¤šçš„ä»£ç è·¯å¾„å’Œå¯èƒ½çš„çŠ¶æ€ -ä¿æŒå¯åŠ¨å‚æ•°çš„æ•°é‡è¾ƒä½ï¼Œå¹¶å°†å¤„ç†å®ƒä»¬çš„æ‰€æœ‰ä»£ç åŒ…å«åœ¨ä¸€ä¸ªå•ç‹¬çš„åœ°æ–¹ï¼Œç¡®å®æœ‰åŠ©äºé™ä½é£é™©ã€‚ å°±åƒè®¸å¤šä¸œè¥¿ä¸€æ ·ï¼Œè¿™æ˜¯ä¸€ç§é£é™©ä¸å›æŠ¥çš„å¹³è¡¡è¡Œä¸ºï¼Œé€‰æ‹©ä¸€äº›å…³é”®çš„å‘è¡Œè®ºæ®(å¹¶æ¸…é™¤æ—§çš„è®ºæ®)ç»å¯¹èƒ½å¤Ÿè®©æˆ‘ä»¬è·å¾—æœ‰åˆ©çš„å¹³è¡¡ã€‚</p>
<p><a href="https://www.swiftbysundell.com/articles/launch-arguments-in-swift/">åŸæ–‡é“¾æ¥</a></p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://kayouyou.github.io/tag/a9KfQSrRb/" class="tag">
                    scripting
                  </a>
                
                  <a href="https://kayouyou.github.io/tag/VadC328gp/" class="tag">
                    debugging
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://kayouyou.github.io/post/type-safe-identifiers-in-swift/">
                  <h3 class="post-title">
                    Type-safe identifiers in Swift
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
</html>
