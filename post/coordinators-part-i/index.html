<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Coordinators Part I | Kayouyou&#39;s Den</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://kayouyou.github.io/favicon.ico?v=1679904102931">
<link rel="stylesheet" href="https://kayouyou.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="

Coordinators Part I

What is flow in mobile applications?

How do we usually manage screens in flow?
Summary of the in..." />
    <meta name="keywords" content="coordinator" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://kayouyou.github.io">
        <img src="https://kayouyou.github.io/images/avatar.png?v=1679904102931" class="site-logo">
        <h1 class="site-title">Kayouyou&#39;s Den</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      The wise build bridges, while the foolish build barriers.
    </div>
    <div class="site-footer">
       <a href="https://beian.miit.gov.cn/">è±«ICPå¤‡2021012281å·-1</a> | <a class="rss" href="https://kayouyou.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Coordinators Part I</h2>
            <div class="post-date">2021-06-08</div>
            
            <div class="post-content" v-pre>
              <!-- TOC -->
<ul>
<li><a href="#coordinators-part-i">Coordinators Part I</a>
<ul>
<li><a href="#what-is-flow-in-mobile-applications">What is flow in mobile applications?</a>
<ul>
<li><a href="#how-do-we-usually-manage-screens-in-flow">How do we usually manage screens in flow?</a></li>
<li><a href="#summary-of-the-introduction">Summary of the introduction</a></li>
</ul>
</li>
<li><a href="#coordinators">Coordinators</a>
<ul>
<li><a href="#module">Module</a></li>
<li><a href="#what-is-coordinator">What is Coordinator?</a></li>
<li><a href="#why-should-we-use-it">Why should we use it?</a></li>
<li><a href="#what-parts-does-the-coordinator-consist-of">What parts does the Coordinator consist of?</a></li>
<li><a href="#what-do-we-need-for-coordinators-to-work">What do we need for Coordinators to work?</a></li>
</ul>
</li>
<li><a href="#router">Router</a></li>
<li><a href="#factory">Factory</a></li>
<li><a href="#storage">Storage</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h1 id="coordinators-part-i">Coordinators Part I</h1>
<h2 id="what-is-flow-in-mobile-applications">What is flow in mobile applications?</h2>
<p>æµæ˜¯é€»è¾‘é“¾æ¥çš„å±å¹•é˜Ÿåˆ—ã€‚æˆ‘ä»¬æ‰€æœ‰çš„å±å¹•éƒ½å¯ä»¥æŒ‰æµç¨‹åˆ’åˆ†ï¼šèº«ä»½éªŒè¯æµç¨‹ã€ç”µè¯éªŒè¯æµç¨‹ã€é¢„è®¢æµç¨‹ã€ä¸ªäººèµ„æ–™ç¼–è¾‘æµç¨‹ç­‰ã€‚</p>
<h3 id="how-do-we-usually-manage-screens-in-flow">How do we usually manage screens in flow?</h3>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªauthæµï¼Œåœ¨è¿™ä¸ªæµä¸­æˆ‘ä»¬éœ€è¦éªŒè¯ç”¨æˆ·çš„ç”µè¯ã€‚</p>
<p>æˆ‘ä»¬ä»¥è¿™æ ·ä¸€ä¸ªæ–¹æ¡ˆä¸ºä¾‹ï¼š</p>
<figure data-type="image" tabindex="1"><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gralo5ta4yj312w0md410.jpg" alt="avatar" loading="lazy"></figure>
<p>æˆ‘ä»¬é€šå¸¸å¦‚ä½•å¤„ç†è¿™ä¸ªæµç¨‹ä¸­çš„å¯¼èˆªï¼Ÿ</p>
<p>åœ¨æœ€å¸¸è§çš„æƒ…å†µä¸‹ï¼Œcontrollerå‘Šè¯‰routeræ¨é€ä¸€ä¸ªæ–°çš„æ§åˆ¶å™¨ã€‚åœ¨ä»£ç ä¸­æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="language-swift">func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell {
        if ğŸŒğŸŒ {
            router.openControllerA()
        } else if ğŸŒğŸŒğŸŒ {
            router.openControllerB()
        } else if ğŸ  {
            router.openControllerC()
        } else if ğŸğŸ {
            router.openControllerD()
        }
}
</code></pre>
<p>æ§åˆ¶å™¨ä¸æ‰€æœ‰ç›¸é‚»çš„æ§åˆ¶å™¨å®Œå…¨é“¾æ¥ï¼Œå¹¶è¯•å›¾å¯¹å…¶è¿›è¡Œç®¡ç†ã€‚çœ‹èµ·æ¥åƒè‹è”æ¼«ç”»é‡Œçš„æ ¼ç½—è«æ³½å¡ï¼š</p>
<figure data-type="image" tabindex="2"><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gralpvn9j8j30go0cial2.jpg" alt="avatar" loading="lazy"></figure>
<p>ä¸‹ä¸€ç§å¸¸è§æƒ…å†µæ˜¯åœ¨æ§åˆ¶å™¨ä¹‹é—´å‘é€æ•°æ®ã€‚</p>
<figure data-type="image" tabindex="3"><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gralq8rdrtj312w07zdhj.jpg" alt="avatar" loading="lazy"></figure>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€å †æ§åˆ¶å™¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å®ƒä»¬ä¹‹é—´å…±äº«æ•°æ®ã€‚æˆ‘ä»¬å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ï¼Ÿ</p>
<pre><code class="language-swift">func prepare(for segue: UIStoryboardSegue, sender: Any?) {
  if segue.identifier == &quot;openControllerA&quot; {
    let vc = segue.destinationViewController as! ControllerA
    vc.monkey = ğŸ’
  } else if segue.identifier == &quot;openControllerB&quot; {
    let vc = segue.destinationViewController as! ControllerB
    vc.tiger = ğŸ¯
  } else if segue.identifier == &quot;openControllerC&quot; {
    let vc = segue.destinationViewController as! ControllerC
    vc.frog = ğŸ¸
  } else if segue.identifier == &quot;openControllerD&quot; {
    let vc = segue.destinationViewController as! ControllerD
    vc.snake = ğŸ
  }
}
</code></pre>
<p>å¤ªå¥½äº†ï¼æˆ‘ä»¬åˆ›é€ äº†ä¸€ä¸ªè€¦åˆæµã€‚ç°åœ¨é¡¹ç›®ç»ç†æ¥æ‰¾æˆ‘ä»¬è¯´ï¼š</p>
<figure data-type="image" tabindex="4"><img src="https://tva1.sinaimg.cn/large/008i3skNly1grals98airj30eq0b8ahd.jpg" alt="avatar" loading="lazy"></figure>
<p>ä½¿æµç‹¬ç«‹çš„å¦ä¸€ä¸ªå¸¸è§åŸå› æ˜¯å®ƒä»¬èƒ½å¤Ÿåœ¨ä¸åŒçš„åœ°æ–¹é‡ç”¨ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨æœ‰ä¸€ä¸ªphone verifyæµï¼Œå¹¶æˆåŠŸåœ°å°†å…¶ç”¨ä½œauthæµçš„ä¸€éƒ¨åˆ†ã€‚ç°åœ¨ï¼Œå¦‚æœæ‚¨éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ç›¸åŒçš„æµï¼Œyou canã€‚</p>
<h3 id="summary-of-the-introduction">Summary of the introduction</h3>
<p>ç›´æ¥å¤„ç†æµçš„æ–¹æ³•é€šå¸¸ç»“æœå¾ˆç³Ÿç³•ï¼š</p>
<ul>
<li>controllers are hard to reuse</li>
<li>every controller knows about other controllers</li>
<li>hard to change flow</li>
<li>hard to test</li>
</ul>
<h2 id="coordinators">Coordinators</h2>
<h3 id="module">Module</h3>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹æ¨¡å—ã€‚æ¨¡å—æ˜¯MVCã€MVPã€MVVMå’ŒViperæ¶æ„æ–¹æ³•çš„ä¸€ä¸ªæ¶æ„å…ƒç´ ã€‚åœ¨æœ€ç®€å•çš„æƒ…å†µä¸‹ï¼Œå¯¹äºMVCï¼Œmoduleæ˜¯ä¸€ä¸ªæ§åˆ¶å™¨ï¼Œå¯¹äºViperï¼Œmoduleæ˜¯ä¸€ä¸ªInteractor-Presenterè§†å›¾ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦åšçš„æ˜¯ç¼–æ’æ¨¡å—ã€‚</p>
<h3 id="what-is-coordinator">What is Coordinator?</h3>
<p>Coordinatoræ˜¯ä¸€ä¸ªå¤„ç†å¯¼èˆªæµçš„å¯¹è±¡ï¼Œå®ƒåœ¨åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªé“¾ä¹‹åä¸ºä¸‹ä¸€ä¸ªCoordinatorå…±äº«æµçš„å¤„ç†ã€‚è¿™æ„å‘³ç€åè°ƒå™¨åº”è¯¥åªåœ¨å±å¹•ä¹‹é—´ä¿æŒå¯¼èˆªé€»è¾‘ã€‚åè°ƒå™¨å¯ä»¥ä¿ç•™å¯¹å­˜å‚¨çš„å¼•ç”¨ï¼Œå­˜å‚¨åŒ…å«å·¥å‚ç”¨äºåˆ›å»ºæ¨¡å—çš„æ•°æ®ï¼Œä½†å®ƒä»¬æ°¸è¿œä¸èƒ½å¤„ç†æ¨¡å—çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¹Ÿæ°¸è¿œä¸èƒ½é©±åŠ¨å•å…ƒçš„è¡Œä¸ºã€‚åªæœ‰åœ¨ç‚¹å‡»ä¸€ä¸ªå•å…ƒæ ¼åæŒ‰ä¸‹ä¸‹ä¸€ä¸ªå±å¹•æ—¶ï¼Œæ‰ä¼šå‘ç”Ÿå•å…ƒæ ¼äº¤äº’ã€‚</p>
<h3 id="why-should-we-use-it">Why should we use it?</h3>
<p>ä¸»è¦ç›®æ ‡æ˜¯ä¸å—æ¨¡å—é—´èŒè´£é™åˆ¶ï¼Œå¹¶å®Œå…¨ç‹¬ç«‹åœ°æ„å»ºæ¨¡å—ã€‚åœ¨è¿™ä¸ªè¿­ä»£ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ä¸åŒçš„æµä¸­é‡ç”¨å®ƒä»¬ã€‚</p>
<p>å›åˆ°å‰é¢çš„ç¤ºä¾‹ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•æ”¹è¿›authæµã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ†ç¦»ä¸¤ä¸ªä¸åŒçš„æµï¼šauthå’Œphone verifyã€‚æ‹†åˆ†åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹é‡å¤ä½¿ç”¨å®ƒä»¬ã€‚</p>
<figure data-type="image" tabindex="5"><img src="https://tva1.sinaimg.cn/large/008i3skNly1graly15bglj312w0b70uh.jpg" alt="avatar" loading="lazy"></figure>
<figure data-type="image" tabindex="6"><img src="https://tva1.sinaimg.cn/large/008i3skNly1graly8vuw9j30sa07o3z8.jpg" alt="avatar" loading="lazy"></figure>
<p>ç°åœ¨æˆ‘ä»¬æœ‰ä¸¤ä¸ªåˆ†å¼€çš„æµã€‚</p>
<p>è®©æˆ‘ä»¬çœ‹çœ‹å¼•æ“ç›–ä¸‹é¢ã€‚</p>
<h3 id="what-parts-does-the-coordinator-consist-of">What parts does the Coordinator consist of?</h3>
<p>è®©æˆ‘ä»¬ä»é€šç”¨æ¥å£å¼€å§‹ã€‚</p>
<p>æ‰€æœ‰Coordinatorå¿…é¡»éµå®ˆåè®®ï¼š</p>
<pre><code class="language-swift">protocol Coordinator: class {
    func start()
}
</code></pre>
<p>è¿™æ„å‘³ç€å¦‚æœæ‚¨æƒ³è¿è¡Œä¸€ä¸ªæ–°çš„æµï¼Œæ‚¨éœ€è¦ä½¿ç”¨factoryåˆ›å»ºä¸€ä¸ªåè°ƒå™¨å¹¶è°ƒç”¨startï¼ˆï¼‰ã€‚</p>
<p>æ‰€æœ‰åè°ƒå™¨éƒ½æœ‰å•ç‹¬çš„finishå—æ¥æ”¯æŒä¸šåŠ¡è§„åˆ™ï¼š</p>
<pre><code class="language-swift">protocol CoordinatorOutput {
    var finishFlow: (Item -&gt; Void)? { get set }
}
</code></pre>
<p>ä¾‹å¦‚ï¼Œå¦‚æœæµçš„ç»“æœåº”è¯¥æ˜¯åˆ›å»ºitemï¼Œé‚£ä¹ˆåè°ƒå™¨å¯ä»¥å°†å…¶è¿”å›åˆ°finishå—ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåè°ƒå™¨çš„æ¥å£å°†ç”±ä¸¤ä¸ªåè®®ç»„æˆï¼ŒCoordinator &amp; CoordinatorOutput.</p>
<p>åœ¨èº«ä»½éªŒè¯æµæœŸé—´ï¼Œç”¨æˆ·å¿…é¡»éªŒè¯ç”¨æˆ·çš„ç”µè¯ã€‚è¿™æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„æµï¼ˆauthå’Œphone verifyï¼‰ï¼Œä½†æ˜¯å½“æˆ‘ä»¬è¿è¡Œauth Coordinatoræ—¶ï¼Œæˆ‘ä»¬å¹¶ä¸å…³å¿ƒè¿™ä¸ªé€»è¾‘ã€‚æˆ‘ä»¬åªéœ€åˆ›å»ºåè°ƒå™¨ï¼Œé…ç½®finishå—ï¼Œç„¶åè°ƒç”¨startï¼ˆï¼‰ã€‚</p>
<figure data-type="image" tabindex="7"><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gram6c6t69j30r80gygm9.jpg" alt="avatar" loading="lazy"></figure>
<h3 id="what-do-we-need-for-coordinators-to-work">What do we need for Coordinators to work?</h3>
<p>æˆ‘ä»¬å¯ä»¥è½»æ¾åœ°æ›´æ”¹è¦ä½¿ç”¨çš„ç±»çš„æ•°é‡ï¼Œä½†é€šå¸¸çš„è®¾ç½®å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ul>
<li><strong>Router</strong>, ç”¨äºå¯¼èˆªï¼ˆè·¯ç”±å™¨åªæ˜¯è·¯çº¿ï¼åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­æ˜¯è¢«åŠ¨çš„ï¼‰ã€‚</li>
<li><strong>Modulesâ€™ factory</strong>, ç”¨äºåˆ›å»ºæ¨¡å—å’Œæ³¨å…¥æ‰€æœ‰ä¾èµ–é¡¹ã€‚</li>
<li><strong>Coordinatorsâ€™ factory</strong> (optional), ä»¥é˜²æˆ‘ä»¬éœ€è¦åˆ‡æ¢åˆ°å¦ä¸€ä¸ªæµã€‚</li>
<li><strong>Storage</strong> (optional), åªæœ‰æˆ‘ä»¬éœ€è¦å­˜å‚¨æ•°æ®å¹¶å°†å…¶æ³¨å…¥åˆ°æ¨¡å—ä¸­ã€‚</li>
</ul>
<figure data-type="image" tabindex="8"><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gram8waxdnj312w0fwabr.jpg" alt="avatar" loading="lazy"></figure>
<p>Coordinatorâ€™s initialization:</p>
<pre><code class="language-swift">final class ItemCoordinator {
  private let factory: ItemModuleFactory
  private let coordinatorFactory: CoordinatorFactory
  private let router: Router
  
  init(router: Router,
       factory: ItemModuleFactory,
       coordinatorFactory: CoordinatorFactory) {
    self.router = router
    self.factory = factory
    self.coordinatorFactory = coordinatorFactory
  }
}
</code></pre>
<p>åè°ƒå™¨çš„ä¸»ä½“ç”±ä¸¤ç±»å‡½æ•°ç»„æˆã€‚å¦‚æœæ‚¨éœ€è¦å¯åŠ¨ä¸€ä¸ªæ–°æ¨¡å—ï¼Œç¬¬ä¸€ä¸ªfuncåº”è¯¥ä»¥â€œshowâ€å‰ç¼€å‘½åï¼š</p>
<pre><code class="language-swift">func showItemList() {
    let itemsView = factory.makeItemsView()
    itemsView.onItemSelect = { [weak self] (item) in
      self?.showItemDetail(item)
    }
    itemsView.onCreateButtonTap = { [weak self] in
      self?.runCreationCoordinator()
    }
    router.setRootModule(itemsView)
}
</code></pre>
<p>æˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªå‡½æ•°ä¸­åšä»€ä¹ˆï¼Ÿæˆ‘ä»¬è¦æ±‚å·¥å‚åˆ›å»ºä¸€ä¸ªæ¨¡å—ï¼Œé…ç½®å›è°ƒï¼Œå¹¶è¦æ±‚è·¯ç”±å™¨pushå®ƒã€‚</p>
<p>ç¬¬äºŒä¸ªfuncè¿è¡Œæ–°çš„æµï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨å®ƒä»¬ä¹‹é—´åˆ‡æ¢ã€‚å…¶åç§°å§‹ç»ˆä»¥â€œrunâ€å‰ç¼€å¼€å¤´ï¼š</p>
<pre><code class="language-swift">func runCreationFlow() {
  let (coordinator, module) = coordinatorFactory.makeItemCoordinatorBox()
  coordinator.finishFlow = { [weak self, weak coordinator] item in
    self?.router.dismissModule()
    self?.removeDependency(coordinator)
    self?.showItemDetail(item)
  }
  addDependency(coordinator)
  router.present(module)
  coordinator.start()
}
</code></pre>
<p>å·¥å‚åˆ›å»ºç¬¬ä¸€ä¸ªæµçš„æ¨¡å—å’Œåè°ƒå™¨ã€‚æˆ‘ä»¬æ¨é€æ¨¡å—ï¼Œåè°ƒå™¨è¿è¡Œæµã€‚å› ä¸ºåè°ƒå™¨æœ‰ä¸€ä¸ªfinishå—ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»é…ç½®åˆ é™¤æ‰€æœ‰ä¾èµ–é¡¹ã€è§£é™¤æ¨¡å—å¹¶æ˜¾ç¤ºæµå¤„ç†çš„ç»“æœæ‰€åˆ›å»ºçš„é¡¹ã€‚</p>
<p>æ‰€æœ‰åè°ƒå™¨éƒ½ä»åŸºæœ¬åè°ƒå™¨ç»§æ‰¿ã€‚åŸºæœ¬åè°ƒå™¨ç±»ä¿ç•™æ‰€æœ‰ä¾èµ–é€»è¾‘ã€‚å‡ºäºå†…å­˜ç®¡ç†çš„åŸå› ï¼Œæˆ‘ä»¬éœ€è¦å®ƒæ¥ä¿æŒå¯¹æ‰€æœ‰å­åè°ƒå™¨çš„å¼ºå¼•ç”¨ï¼Œå¹¶å…è®¸åè°ƒå™¨è°ƒç”¨å…¶å­å‡½æ•°ï¼ˆè¿™å°±æ˜¯æ·±åº¦é“¾æ¥çš„å·¥ä½œåŸç†ï¼‰ã€‚</p>
<p>åŸºæœ¬åè°ƒå™¨ç±»å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="language-swift">class BaseCoordinator {
  var childCoordinators: [Coordinator] = []
  
  // add only unique object
  func addDependency(_ coordinator: Coordinator) {
    for element in childCoordinators {
      if element === coordinator { return }
    }
    childCoordinators.append(coordinator)
  }
  
  func removeDependency(_ coordinator: Coordinator?) {
    guard
      childCoordinators.isEmpty == false,
      let coordinator = coordinator
      else { return }
    
    for (index, element) in childCoordinators.enumerated() {
      if element === coordinator {
        childCoordinators.remove(at: index)
        break
      }
    }
  }
}
</code></pre>
<p>ä»è¿™ä¸ªä¾‹å­å¯ä»¥ç†è§£ï¼Œçˆ¶åè°ƒå™¨æ‹¥æœ‰æ‰€æœ‰å­å¯¹è±¡çš„å¼•ç”¨ã€‚</p>
<h2 id="router">Router</h2>
<p>æˆ‘ä»¬æ¥è°ˆè°ˆè·¯ç”±å™¨ã€‚æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è¿™ç§æ¨¡å¼ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½ä¿æŒUINavigationControllerçš„å¼•ç”¨å’Œåè°ƒå™¨æœ¬èº«çš„æ¨é€ï¼Ÿ</p>
<p>é¦–å…ˆï¼Œå®ƒæ‰“ç ´äº†å•ä¸€è´£ä»»åŸåˆ™: coordinatorç®¡ç†æµï¼Œä½†ä»ä¸è´Ÿè´£routingã€‚</p>
<p>å…¶æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥æ”¯æŒiPadï¼Œä¹Ÿå¯ä»¥æ·»åŠ è‡ªå®šä¹‰å±å¹•è¿‡æ¸¡ã€‚Coordinatoræ°¸è¿œä¸ä¼šçŸ¥é“ï¼Œå› ä¸ºå®ƒå¯ä»¥ç»§ç»­ä½¿ç”¨è·¯ç”±å™¨çš„åè®®æ¥å£ï¼Œæ¯”å¦‚â€œpushâ€ï¼Œè€Œä¸å…³å¿ƒæ–°çš„è½¬æ¢åŠ¨ç”»ã€‚æ¨é€çš„å®ç°ç»†èŠ‚ç”±routerå†³å®šã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºä¸åŒçš„è®¾å¤‡ï¼ˆå¦‚iPhoneã€iPadã€TVæˆ–Watchï¼‰åˆ›å»ºè·¯ç”±å™¨ç±»çš„ç»„åˆï¼Œå¹¶ä½¿å®ƒä»¬ç¬¦åˆä¸€ä¸ªé€šç”¨åè®®ã€‚</p>
<p>è·¯ç”±å™¨çš„funcs ç”¨ Presentable protocolä½œä¸ºå‚æ•°ï¼š</p>
<pre><code class="language-swift">func push(_ module: Presentable?)
</code></pre>
<p>Presentable looks like this:</p>
<pre><code class="language-swift">protocol Presentable {
  func toPresent() -&gt; UIViewController?
}
</code></pre>
<p>å®ƒæ˜¯ä¸ºçµæ´»æ€§å’ŒæŠ½è±¡æ€§è€Œè®¾è®¡çš„ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦åˆ›å»ºä¸€ä¸ªå¤æ‚çš„æ¨¡å—ï¼Œä½†æ˜¯éœ€è¦æå–UIViewControllerä»¥ä¾›è·¯ç”±å™¨ä½¿ç”¨ã€‚æ¨¡å—å°†ä½¿ç”¨å“ªç§æ–¹æ³•è·å–æ­¤æ§åˆ¶å™¨å¹¶ä¸é‡è¦ã€‚</p>
<h2 id="factory">Factory</h2>
<p>æˆ‘ç›¸ä¿¡æ¯ä¸ªäººéƒ½çŸ¥é“æˆ‘ä»¬åº”è¯¥ä½¿ç”¨è¿™ç§æ¨¡å¼çš„æƒ…å†µã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒçš„å·¥ä½œåŸç†ç±»ä¼¼äºViperçš„ç»„è£…ï¼Œè¿™æ„å‘³ç€å·¥å‚è´Ÿè´£æ¨¡å—çš„æ„å»ºã€‚å®ƒåˆ›å»ºæ‰€æœ‰å¯¹è±¡ï¼Œè®¾ç½®æ‰€æœ‰ä¾èµ–é¡¹ï¼Œæ³¨å…¥å±æ€§ï¼Œå¹¶è¿”å›åè®®ã€‚</p>
<p>åœ¨ä¸€ä¸ªç®€å•çš„æƒ…å†µä¸‹ï¼Œå®ƒå°†åªæ˜¯ä¸€ä¸ªæ§åˆ¶å™¨ï¼š</p>
<pre><code class="language-swift">func makeItemDetailOutput(item: Item) -&gt; ItemDetailView {
  let controller = ItemDetailController.controllerFromStoryboard(.items)
  controller.item = item
  return controller
}
</code></pre>
<p>æˆ‘ä»¬è¿”å›åè®®æ˜¯å› ä¸ºå®ƒæ˜“äºæµ‹è¯•ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éµå¾ªå¼€-å…³åŸåˆ™ã€‚</p>
<p>åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¸ºæ¨¡å—å’Œåè°ƒå™¨ä½¿ç”¨äº†ä¸¤ä¸ªå·¥å‚ç±»ã€‚åœ¨æˆ‘ä»¬çš„å›¢é˜Ÿä¸­ï¼Œæˆ‘ä»¬ç»å†äº†å¾ˆå¤šåœ£æˆ˜ï¼Œå†³å®šåœ¨å“ªäº›æƒ…å†µä¸‹æˆ‘ä»¬åº”è¯¥å»ºç«‹ä¸€ä¸ªå·¥å‚ã€‚ä¸ºæ¯ä¸ªæµåˆ›å»ºä¸€ä¸ªå·¥å‚ç±»ï¼Œè¿˜æ˜¯å°†æ‰€æœ‰æµéƒ½ä¿å­˜åœ¨ä¸€ä¸ªå·¥å‚ç±»ä¸­ï¼Ÿé—®é¢˜æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä¸åŒçš„æµä¸­é‡ç”¨ä¸€ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ä¸åŒçš„å·¥å‚ä¸­å¤åˆ¶ç²˜è´´è¿™äº›æ–¹æ³•ã€‚æ‰€ä»¥æˆ‘ä»¬å†³å®šå°†æ‰€æœ‰æ¨¡å—æ”¾åœ¨ä¸€ä¸ªå·¥å‚ç±»ä¸­ï¼Œå°†æ‰€æœ‰åè°ƒå™¨æ”¾åœ¨å¦ä¸€ä¸ªå·¥å‚ç±»ä¸­ã€‚å¯¹äºæ¯ä¸€ä¸ªæµç¨‹ï¼Œæˆ‘ä»¬éƒ½ä¼šåˆ›å»ºåŒ…å«æ‰€æœ‰å¿…è¦æ¨¡å—çš„å·¥å‚åè®®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="language-swift">protocol ItemModuleFactory {
  func makeItemsOutput() -&gt; ItemsListView
  func makeItemDetailOutput(item: ItemList) -&gt; ItemDetailView
}
</code></pre>
<p>å·¥å‚çš„ç±»åº”ç¬¦åˆæ‰€æœ‰è¿™äº›åè®®ï¼š</p>
<pre><code class="language-swift">class ModuleFactoryImp:
  AuthModuleFactory,
  ItemModuleFactory,
  ItemCreateModuleFactory,
  SettingsModuleFactory {
  /* implementation */
}
</code></pre>
<p>æˆ–è€…coordinatorå·¥å‚æˆ‘ä»¬åªåˆ›å»ºä¸€ä¸ªåè®®ï¼Œä½†æ¯ä¸ªåè°ƒå‘˜éƒ½åº”è¯¥æœ‰å¯èƒ½åˆ›å»ºä»»ä½•å…¶ä»–coordinatorã€‚</p>
<h2 id="storage">Storage</h2>
<p>å­˜å‚¨å™¨ä¿å­˜å·¥å‚ç”¨äºåˆ›å»ºä¸‹ä¸€ä¸ªæ¨¡å—çš„æ‰€æœ‰æ•°æ®ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬çš„æµç”±ä¸‰ä¸ªæ¨¡å—ç»„æˆï¼šAã€Bå’ŒCã€‚åœ¨ä¸€äº›å·¥ä½œä¹‹åï¼Œæˆ‘ä»¬ä»æ¨¡å—aæ£€ç´¢å­—å…¸ï¼Œä»æ¨¡å—Bæ£€ç´¢å­—ç¬¦ä¸²ã€‚æœ€åï¼Œæˆ‘ä»¬å°†è¿™äº›æ•°æ®å‘é€åˆ°æ¨¡å—Cã€‚ç„¶åï¼Œæ¨¡å—Cå¯ä»¥æ·»åŠ ä¸€äº›å…¶ä»–æ•°æ®å¹¶å°†å…¶å‘é€åˆ°æœåŠ¡å™¨ã€‚</p>
<figure data-type="image" tabindex="9"><img src="https://tva1.sinaimg.cn/large/008i3skNgy1grams8lt1nj312w0edtai.jpg" alt="avatar" loading="lazy"></figure>
<pre><code class="language-swift">moduleA.onNext = { [weak self] dict in
  self?.storage.dict = dict
  self?.showModuleB()
}
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥åœ¨å­˜å‚¨ä¸­æ·»åŠ ä¸€äº›é™„åŠ é€»è¾‘ï¼Œä»¥ä¾¿å°†æ•°æ®ä¿å­˜åœ¨å…‰ç›˜ä¸Šæˆ–å°†æ•°æ®æ ¼å¼åŒ–ä¸ºjsonã€‚</p>
<h2 id="conclusion">Conclusion</h2>
<p>è¿™å¯¹äºç¬¬ä¸€éƒ¨åˆ†å¯èƒ½å·²ç»è¶³å¤Ÿäº†ã€‚æˆ‘ä»¬å­¦åˆ°äº†ä»€ä¹ˆå¥½å¤„ï¼Ÿ</p>
<ul>
<li>æ§åˆ¶å™¨å¯¹å…¶ä»–æ§åˆ¶å™¨ä¸€æ— æ‰€çŸ¥</li>
<li>æ§åˆ¶å™¨å¯ä»¥å¾ˆå®¹æ˜“åœ°é›†æˆåˆ°ä¸åŒçš„æµä¸­</li>
<li>æ§åˆ¶å™¨ä¸å‘å…¶ä»–æ§åˆ¶å™¨å‘é€æ•°æ®</li>
<li>å®¹æ˜“é‡ç”¨</li>
<li>ç®€åŒ–æµ‹è¯•</li>
</ul>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://kayouyou.github.io/tag/fkXsOWHsE/" class="tag">
                    coordinator
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://kayouyou.github.io/post/epoxy-document/">
                  <h3 class="post-title">
                    Epoxy Document
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.6.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
</html>
